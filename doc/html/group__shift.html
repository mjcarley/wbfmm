<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>WBFMM: Shift operations</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">WBFMM
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Shift operations</div>  </div>
</div><!--header-->
<div class="contents">

<p>Shift operations (combined rotation and translation) for upward and downward passes, and same-level interactions.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gab903c21b01e1964808e80d7d55bd098b"><td class="memItemLeft" align="right" valign="top">gint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__shift.html#gab903c21b01e1964808e80d7d55bd098b">wbfmm_child_parent_shift</a> (gdouble *Cp, gint Np, gdouble *Cc, gint Nc, gdouble *H03, gdouble *H47, gint Lh, gdouble *shift, gint Ls, gdouble *work)</td></tr>
<tr class="memdesc:gab903c21b01e1964808e80d7d55bd098b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Upward shift of singular expansion from eight children to common parent.  <a href="#gab903c21b01e1964808e80d7d55bd098b">More...</a><br /></td></tr>
<tr class="separator:gab903c21b01e1964808e80d7d55bd098b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga83d0b86e24560d8cfdd2dfa27f1b12d0"><td class="memItemLeft" align="right" valign="top">gint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__shift.html#ga83d0b86e24560d8cfdd2dfa27f1b12d0">wbfmm_parent_child_shift</a> (gdouble *Cc, gint Nc, gdouble *Cp, gint Np, gdouble *H03, gdouble *H47, gint Lh, gdouble *shift, gint Ls, gdouble *work)</td></tr>
<tr class="memdesc:ga83d0b86e24560d8cfdd2dfa27f1b12d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Downward shift of parent expansion to child box centres.  <a href="#ga83d0b86e24560d8cfdd2dfa27f1b12d0">More...</a><br /></td></tr>
<tr class="separator:ga83d0b86e24560d8cfdd2dfa27f1b12d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa40178da843d4cb52e7bfaa0943ce4f9"><td class="memItemLeft" align="right" valign="top">gint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__shift.html#gaa40178da843d4cb52e7bfaa0943ce4f9">wbfmm_shift_angles_list4</a> (gint i, gint j, gint k, gdouble *th, gdouble *ph, gdouble *ch, gdouble *rs)</td></tr>
<tr class="memdesc:gaa40178da843d4cb52e7bfaa0943ce4f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract the rotation angles for boxes on interaction list 4.  <a href="#gaa40178da843d4cb52e7bfaa0943ce4f9">More...</a><br /></td></tr>
<tr class="separator:gaa40178da843d4cb52e7bfaa0943ce4f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga11db3f07271691eac210a96531e88fff"><td class="memItemLeft" align="right" valign="top">gint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__shift.html#ga11db3f07271691eac210a96531e88fff">wbfmm_shift_angle_table_init</a> (void)</td></tr>
<tr class="memdesc:ga11db3f07271691eac210a96531e88fff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize table of angles for shift operations.  <a href="#ga11db3f07271691eac210a96531e88fff">More...</a><br /></td></tr>
<tr class="separator:ga11db3f07271691eac210a96531e88fff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga52a2717f7d9296b7eb2bab0e1193de60"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structwbfmm__shift__operators__t.html">wbfmm_shift_operators_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__shift.html#ga52a2717f7d9296b7eb2bab0e1193de60">wbfmm_shift_operators_new</a> (guint L, gdouble *work)</td></tr>
<tr class="memdesc:ga52a2717f7d9296b7eb2bab0e1193de60"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate shift operators and initialize rotations.  <a href="#ga52a2717f7d9296b7eb2bab0e1193de60">More...</a><br /></td></tr>
<tr class="separator:ga52a2717f7d9296b7eb2bab0e1193de60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9893c7f26d7eabc482545ba9ff423019"><td class="memItemLeft" align="right" valign="top">gint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__shift.html#ga9893c7f26d7eabc482545ba9ff423019">wbfmm_child_parent_shift_f</a> (gfloat *Cp, gint Np, gfloat *Cc, gint Nc, gfloat *H03, gfloat *H47, gint Lh, gfloat *shift, gint Ls, gfloat *work)</td></tr>
<tr class="memdesc:ga9893c7f26d7eabc482545ba9ff423019"><td class="mdescLeft">&#160;</td><td class="mdescRight">Upward shift of singular expansion from eight children to common parent.  <a href="#ga9893c7f26d7eabc482545ba9ff423019">More...</a><br /></td></tr>
<tr class="separator:ga9893c7f26d7eabc482545ba9ff423019"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa8395903b13cb472fab3dbdc77308bd9"><td class="memItemLeft" align="right" valign="top">gint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__shift.html#gaa8395903b13cb472fab3dbdc77308bd9">wbfmm_parent_child_shift_f</a> (gfloat *Cc, gint Nc, gfloat *Cp, gint Np, gfloat *H03, gfloat *H47, gint Lh, gfloat *shift, gint Ls, gfloat *work)</td></tr>
<tr class="memdesc:gaa8395903b13cb472fab3dbdc77308bd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Downward shift of parent expansion to child box centres.  <a href="#gaa8395903b13cb472fab3dbdc77308bd9">More...</a><br /></td></tr>
<tr class="separator:gaa8395903b13cb472fab3dbdc77308bd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4b35b119dfc23a825662bd31c26b0da1"><td class="memItemLeft" align="right" valign="top">gint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__shift.html#ga4b35b119dfc23a825662bd31c26b0da1">wbfmm_shift_angles_list4_f</a> (gint i, gint j, gint k, gfloat *th, gfloat *ph, gfloat *ch, gfloat *rs)</td></tr>
<tr class="memdesc:ga4b35b119dfc23a825662bd31c26b0da1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Extract the rotation angles for boxes on interaction list 4.  <a href="#ga4b35b119dfc23a825662bd31c26b0da1">More...</a><br /></td></tr>
<tr class="separator:ga4b35b119dfc23a825662bd31c26b0da1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4539d9cd56e8aa5aeb10fec80ea20b9b"><td class="memItemLeft" align="right" valign="top">gint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__shift.html#ga4539d9cd56e8aa5aeb10fec80ea20b9b">wbfmm_shift_angle_table_init_f</a> (void)</td></tr>
<tr class="memdesc:ga4539d9cd56e8aa5aeb10fec80ea20b9b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize table of angles for shift operations.  <a href="#ga4539d9cd56e8aa5aeb10fec80ea20b9b">More...</a><br /></td></tr>
<tr class="separator:ga4539d9cd56e8aa5aeb10fec80ea20b9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaac4cf2fb554c4af5ab71b733a1244d2f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structwbfmm__shift__operators__t.html">wbfmm_shift_operators_t</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__shift.html#gaac4cf2fb554c4af5ab71b733a1244d2f">wbfmm_shift_operators_new_f</a> (guint L, gfloat *work)</td></tr>
<tr class="memdesc:gaac4cf2fb554c4af5ab71b733a1244d2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocate shift operators and initialize rotations.  <a href="#gaac4cf2fb554c4af5ab71b733a1244d2f">More...</a><br /></td></tr>
<tr class="separator:gaac4cf2fb554c4af5ab71b733a1244d2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Shift operations (combined rotation and translation) for upward and downward passes, and same-level interactions. </p>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gab903c21b01e1964808e80d7d55bd098b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint wbfmm_child_parent_shift </td>
          <td>(</td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>Cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>Np</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>Cc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>Nc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>H03</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>H47</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>Lh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>trans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>Ls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>work</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Upward shift of singular expansion from eight children to common parent. </p>
<p>Shift the expansion of eight child boxes to their parent and sum into the parent expansion. This function assumes data are packed with a stride of eight elements so that all expansion coefficients of a given order are contiguous in memory, ordered by Morton index.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Cp</td><td>parent expansion array; </td></tr>
    <tr><td class="paramname">Np</td><td>order of parent expansion; </td></tr>
    <tr><td class="paramname">Cc</td><td>child expansion array; </td></tr>
    <tr><td class="paramname">Nc</td><td>order of child expansions; </td></tr>
    <tr><td class="paramname">H03</td><td>rotation coefficients for `lower' children (Morton index 0-3); </td></tr>
    <tr><td class="paramname">H47</td><td>rotation coefficients for `upper' children (Morton index 4-7); </td></tr>
    <tr><td class="paramname">Lh</td><td>maximum order of rotation coefficients; </td></tr>
    <tr><td class="paramname">trans</td><td>coaxial translation operator for distance between child and parent box centres; </td></tr>
    <tr><td class="paramname">Ls</td><td>order of <em>trans</em>; </td></tr>
    <tr><td class="paramname">work</td><td>workspace</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd></dl>

</div>
</div>
<a class="anchor" id="ga9893c7f26d7eabc482545ba9ff423019"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint wbfmm_child_parent_shift_f </td>
          <td>(</td>
          <td class="paramtype">gfloat *&#160;</td>
          <td class="paramname"><em>Cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>Np</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gfloat *&#160;</td>
          <td class="paramname"><em>Cc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>Nc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gfloat *&#160;</td>
          <td class="paramname"><em>H03</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gfloat *&#160;</td>
          <td class="paramname"><em>H47</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>Lh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gfloat *&#160;</td>
          <td class="paramname"><em>trans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>Ls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gfloat *&#160;</td>
          <td class="paramname"><em>work</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Upward shift of singular expansion from eight children to common parent. </p>
<p>Shift the expansion of eight child boxes to their parent and sum into the parent expansion. This function assumes data are packed with a stride of eight elements so that all expansion coefficients of a given order are contiguous in memory, ordered by Morton index.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Cp</td><td>parent expansion array; </td></tr>
    <tr><td class="paramname">Np</td><td>order of parent expansion; </td></tr>
    <tr><td class="paramname">Cc</td><td>child expansion array; </td></tr>
    <tr><td class="paramname">Nc</td><td>order of child expansions; </td></tr>
    <tr><td class="paramname">H03</td><td>rotation coefficients for `lower' children (Morton index 0-3); </td></tr>
    <tr><td class="paramname">H47</td><td>rotation coefficients for `upper' children (Morton index 4-7); </td></tr>
    <tr><td class="paramname">Lh</td><td>maximum order of rotation coefficients; </td></tr>
    <tr><td class="paramname">trans</td><td>coaxial translation operator for distance between child and parent box centres; </td></tr>
    <tr><td class="paramname">Ls</td><td>order of <em>trans</em>; </td></tr>
    <tr><td class="paramname">work</td><td>workspace</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd></dl>

</div>
</div>
<a class="anchor" id="ga83d0b86e24560d8cfdd2dfa27f1b12d0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint wbfmm_parent_child_shift </td>
          <td>(</td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>Cc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>Nc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>Cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>Np</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>H03</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>H47</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>Lh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>trans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>Ls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>work</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Downward shift of parent expansion to child box centres. </p>
<p>Shift the (regular) expansion data from a parent box to each of its child boxes, assuming the same packing as in <a class="el" href="group__shift.html#gab903c21b01e1964808e80d7d55bd098b" title="Upward shift of singular expansion from eight children to common parent. ">wbfmm_child_parent_shift</a>(...). Note that the rotation matrices for this function are switched relative to the rotations of the same name in <a class="el" href="group__shift.html#gab903c21b01e1964808e80d7d55bd098b" title="Upward shift of singular expansion from eight children to common parent. ">wbfmm_child_parent_shift</a>(...), because the `upper' children rotate `down' to be shifted to the parent centre but the rotation is `up' to shift from the parent to those children, and similarly for the `lower' children.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Cc</td><td>child expansion array; </td></tr>
    <tr><td class="paramname">Nc</td><td>order of child expansions; </td></tr>
    <tr><td class="paramname">Cp</td><td>parent expansion array; </td></tr>
    <tr><td class="paramname">Np</td><td>order of parent expansion; </td></tr>
    <tr><td class="paramname">H03</td><td>rotation coefficients for `lower' children (Morton index 0-3); </td></tr>
    <tr><td class="paramname">H47</td><td>rotation coefficients for `upper' children (Morton index 4-7); </td></tr>
    <tr><td class="paramname">Lh</td><td>maximum order of rotation coefficients; </td></tr>
    <tr><td class="paramname">trans</td><td>coaxial translation operator for distance between child and parent box centres; </td></tr>
    <tr><td class="paramname">Ls</td><td>order of <em>trans</em>; </td></tr>
    <tr><td class="paramname">work</td><td>workspace</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd></dl>

</div>
</div>
<a class="anchor" id="gaa8395903b13cb472fab3dbdc77308bd9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint wbfmm_parent_child_shift_f </td>
          <td>(</td>
          <td class="paramtype">gfloat *&#160;</td>
          <td class="paramname"><em>Cc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>Nc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gfloat *&#160;</td>
          <td class="paramname"><em>Cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>Np</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gfloat *&#160;</td>
          <td class="paramname"><em>H03</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gfloat *&#160;</td>
          <td class="paramname"><em>H47</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>Lh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gfloat *&#160;</td>
          <td class="paramname"><em>trans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>Ls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gfloat *&#160;</td>
          <td class="paramname"><em>work</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Downward shift of parent expansion to child box centres. </p>
<p>Shift the (regular) expansion data from a parent box to each of its child boxes, assuming the same packing as in <a class="el" href="group__shift.html#ga9893c7f26d7eabc482545ba9ff423019" title="Upward shift of singular expansion from eight children to common parent. ">wbfmm_child_parent_shift_f</a>(...). Note that the rotation matrices for this function are switched relative to the rotations of the same name in <a class="el" href="group__shift.html#ga9893c7f26d7eabc482545ba9ff423019" title="Upward shift of singular expansion from eight children to common parent. ">wbfmm_child_parent_shift_f</a>(...), because the `upper' children rotate `down' to be shifted to the parent centre but the rotation is `up' to shift from the parent to those children, and similarly for the `lower' children.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Cc</td><td>child expansion array; </td></tr>
    <tr><td class="paramname">Nc</td><td>order of child expansions; </td></tr>
    <tr><td class="paramname">Cp</td><td>parent expansion array; </td></tr>
    <tr><td class="paramname">Np</td><td>order of parent expansion; </td></tr>
    <tr><td class="paramname">H03</td><td>rotation coefficients for `lower' children (Morton index 0-3); </td></tr>
    <tr><td class="paramname">H47</td><td>rotation coefficients for `upper' children (Morton index 4-7); </td></tr>
    <tr><td class="paramname">Lh</td><td>maximum order of rotation coefficients; </td></tr>
    <tr><td class="paramname">trans</td><td>coaxial translation operator for distance between child and parent box centres; </td></tr>
    <tr><td class="paramname">Ls</td><td>order of <em>trans</em>; </td></tr>
    <tr><td class="paramname">work</td><td>workspace</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd></dl>

</div>
</div>
<a class="anchor" id="ga11db3f07271691eac210a96531e88fff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint wbfmm_shift_angle_table_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize table of angles for shift operations. </p>
<p>This function must be called before any interaction calculations are performed, in particular before any call to <a class="el" href="group__shift.html#ga52a2717f7d9296b7eb2bab0e1193de60" title="Allocate shift operators and initialize rotations. ">wbfmm_shift_operators_new</a>(...), in order to initialize the look-up table of orientations between boxes in interaction lists.</p>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd></dl>

</div>
</div>
<a class="anchor" id="ga4539d9cd56e8aa5aeb10fec80ea20b9b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint wbfmm_shift_angle_table_init_f </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize table of angles for shift operations. </p>
<p>This function must be called before any interaction calculations are performed, in particular before any call to <a class="el" href="group__shift.html#gaac4cf2fb554c4af5ab71b733a1244d2f" title="Allocate shift operators and initialize rotations. ">wbfmm_shift_operators_new_f</a>(...), in order to initialize the look-up table of orientations between boxes in interaction lists.</p>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd></dl>

</div>
</div>
<a class="anchor" id="gaa40178da843d4cb52e7bfaa0943ce4f9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint wbfmm_shift_angles_list4 </td>
          <td>(</td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>ph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>ch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>rs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extract the rotation angles for boxes on interaction list 4. </p>
<p>Find the rotation angles <img class="formulaInl" alt="$(\theta,\phi\,\chi)$" src="form_9.png"/> between a box at integer coordinates <img class="formulaInl" alt="$(i,j,k)$" src="form_18.png"/>, using a look-up table which should be initialized with <a class="el" href="group__shift.html#ga11db3f07271691eac210a96531e88fff" title="Initialize table of angles for shift operations. ">wbfmm_shift_angle_table_init</a>(...)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>integer <img class="formulaInl" alt="$x$" src="form_3.png"/> coordinate of box on interaction list; </td></tr>
    <tr><td class="paramname">j</td><td>integer <img class="formulaInl" alt="$y$" src="form_4.png"/> coordinate of box on interaction list; </td></tr>
    <tr><td class="paramname">k</td><td>integer <img class="formulaInl" alt="$z$" src="form_5.png"/> coordinate of box on interaction list; </td></tr>
    <tr><td class="paramname">th</td><td><img class="formulaInl" alt="$\theta$" src="form_6.png"/> for rotation between boxes; </td></tr>
    <tr><td class="paramname">ph</td><td><img class="formulaInl" alt="$\phi$" src="form_7.png"/> for rotation between boxes; </td></tr>
    <tr><td class="paramname">ch</td><td><img class="formulaInl" alt="$\chi$" src="form_8.png"/> for rotation between boxes; </td></tr>
    <tr><td class="paramname">rs</td><td>scaling factor for distance between box centres, distance is <em>rs</em> multiplied by box width.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd></dl>

</div>
</div>
<a class="anchor" id="ga4b35b119dfc23a825662bd31c26b0da1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gint wbfmm_shift_angles_list4_f </td>
          <td>(</td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gint&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gfloat *&#160;</td>
          <td class="paramname"><em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gfloat *&#160;</td>
          <td class="paramname"><em>ph</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gfloat *&#160;</td>
          <td class="paramname"><em>ch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gfloat *&#160;</td>
          <td class="paramname"><em>rs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Extract the rotation angles for boxes on interaction list 4. </p>
<p>Find the rotation angles <img class="formulaInl" alt="$(\theta,\phi\,\chi)$" src="form_9.png"/> between a box at integer coordinates <img class="formulaInl" alt="$(i,j,k)$" src="form_18.png"/>, using a look-up table which should be initialized with <a class="el" href="group__shift.html#ga4539d9cd56e8aa5aeb10fec80ea20b9b" title="Initialize table of angles for shift operations. ">wbfmm_shift_angle_table_init_f</a>(...)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">i</td><td>integer <img class="formulaInl" alt="$x$" src="form_3.png"/> coordinate of box on interaction list; </td></tr>
    <tr><td class="paramname">j</td><td>integer <img class="formulaInl" alt="$y$" src="form_4.png"/> coordinate of box on interaction list; </td></tr>
    <tr><td class="paramname">k</td><td>integer <img class="formulaInl" alt="$z$" src="form_5.png"/> coordinate of box on interaction list; </td></tr>
    <tr><td class="paramname">th</td><td><img class="formulaInl" alt="$\theta$" src="form_6.png"/> for rotation between boxes; </td></tr>
    <tr><td class="paramname">ph</td><td><img class="formulaInl" alt="$\phi$" src="form_7.png"/> for rotation between boxes; </td></tr>
    <tr><td class="paramname">ch</td><td><img class="formulaInl" alt="$\chi$" src="form_8.png"/> for rotation between boxes; </td></tr>
    <tr><td class="paramname">rs</td><td>scaling factor for distance between box centres, distance is <em>rs</em> multiplied by box width.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd></dl>

</div>
</div>
<a class="anchor" id="ga52a2717f7d9296b7eb2bab0e1193de60"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structwbfmm__shift__operators__t.html">wbfmm_shift_operators_t</a> * wbfmm_shift_operators_new </td>
          <td>(</td>
          <td class="paramtype">guint&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gdouble *&#160;</td>
          <td class="paramname"><em>work</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate shift operators and initialize rotations. </p>
<p>Allocate a new <a class="el" href="structwbfmm__shift__operators__t.html">wbfmm_shift_operators_t</a> of given maximum order and initialize the rotation coefficients needed for same-level interaction calculations and upward and downward passes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">L</td><td>maximum order of expansions; </td></tr>
    <tr><td class="paramname">work</td><td>workspace.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd></dl>

</div>
</div>
<a class="anchor" id="gaac4cf2fb554c4af5ab71b733a1244d2f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structwbfmm__shift__operators__t.html">wbfmm_shift_operators_t</a> * wbfmm_shift_operators_new_f </td>
          <td>(</td>
          <td class="paramtype">guint&#160;</td>
          <td class="paramname"><em>L</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gfloat *&#160;</td>
          <td class="paramname"><em>work</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocate shift operators and initialize rotations. </p>
<p>Allocate a new <a class="el" href="structwbfmm__shift__operators__t.html">wbfmm_shift_operators_t</a> of given maximum order and initialize the rotation coefficients needed for same-level interaction calculations and upward and downward passes.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">L</td><td>maximum order of expansions; </td></tr>
    <tr><td class="paramname">work</td><td>workspace.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on success </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Mon Jul 15 2019 14:49:08 for WBFMM by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
