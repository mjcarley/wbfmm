\section{Boxes and octrees}
\label{group__boxes}\index{Boxes and octrees@{Boxes and octrees}}


Operations on octree boxes and trees.  


\subsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct {\bf wbfmm\+\_\+box\+\_\+t}
\item 
struct {\bf wbfmm\+\_\+tree\+\_\+t}
\item 
struct {\bf wbfmm\+\_\+target\+\_\+list\+\_\+t}
\item 
struct {\bf wbfmm\+\_\+shift\+\_\+operators\+\_\+t}
\end{DoxyCompactItemize}
\subsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum {\bf wbfmm\+\_\+problem\+\_\+t} \{ {\bf W\+B\+F\+M\+M\+\_\+\+P\+R\+O\+B\+L\+E\+M\+\_\+\+L\+A\+P\+L\+A\+C\+E} = 1, 
{\bf W\+B\+F\+M\+M\+\_\+\+P\+R\+O\+B\+L\+E\+M\+\_\+\+H\+E\+L\+M\+H\+O\+L\+T\+Z} = 2
 \}
\item 
enum {\bf wbfmm\+\_\+field\+\_\+t} \{ {\bf W\+B\+F\+M\+M\+\_\+\+F\+I\+E\+L\+D\+\_\+\+S\+C\+A\+L\+A\+R} = 1 $<$$<$ 0, 
{\bf W\+B\+F\+M\+M\+\_\+\+F\+I\+E\+L\+D\+\_\+\+G\+R\+A\+D\+I\+E\+N\+T} = 1 $<$$<$ 1, 
{\bf W\+B\+F\+M\+M\+\_\+\+F\+I\+E\+L\+D\+\_\+\+C\+U\+R\+L} = 1 $<$$<$ 2
 \}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
gint {\bf wbfmm\+\_\+tree\+\_\+add\+\_\+points} ({\bf wbfmm\+\_\+tree\+\_\+t} $\ast$t, gpointer pts, guint npts, gsize pstr)
\begin{DoxyCompactList}\small\item\em Add points to an octree. \end{DoxyCompactList}\item 
{\bf wbfmm\+\_\+tree\+\_\+t} $\ast$ {\bf wbfmm\+\_\+tree\+\_\+new} (gdouble $\ast$x, gdouble D, guint maxpoints)
\begin{DoxyCompactList}\small\item\em Allocate a new octree. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+tree\+\_\+leaf\+\_\+expansions} ({\bf wbfmm\+\_\+tree\+\_\+t} $\ast$t, gdouble k, gdouble $\ast$src, gint sstr, gdouble $\ast$normals, gint nstr, gdouble $\ast$dipoles, gint dstr, gboolean zero\+\_\+expansions, gdouble $\ast$work)
\begin{DoxyCompactList}\small\item\em Generate leaf expansions for a tree. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+tree\+\_\+box\+\_\+field} ({\bf wbfmm\+\_\+tree\+\_\+t} $\ast$t, guint level, guint b, gdouble k, gdouble $\ast$x, gdouble $\ast$f, gint fstr, gdouble $\ast$work)
\begin{DoxyCompactList}\small\item\em Evaluate singular expansion about a box centre. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+tree\+\_\+box\+\_\+local\+\_\+field} ({\bf wbfmm\+\_\+tree\+\_\+t} $\ast$t, guint level, guint b, gdouble k, gdouble $\ast$x, gdouble $\ast$f, gint fstr, gdouble $\ast$src, gint sstr, gboolean eval\+\_\+neighbours, guint field, gdouble $\ast$work)
\begin{DoxyCompactList}\small\item\em Evaluate local field from regular expansion in box. \end{DoxyCompactList}\item 
guint64 {\bf wbfmm\+\_\+point\+\_\+index\+\_\+3d} (gdouble $\ast$x, gdouble $\ast$c, gdouble D)
\begin{DoxyCompactList}\small\item\em Find Morton index for point in a cubic domain. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+tree\+\_\+coefficient\+\_\+init} ({\bf wbfmm\+\_\+tree\+\_\+t} $\ast$t, guint l, guint nr, guint ns)
\begin{DoxyCompactList}\small\item\em Initialize expansion coefficient data in an octree. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+tree\+\_\+refine} ({\bf wbfmm\+\_\+tree\+\_\+t} $\ast$t)
\begin{DoxyCompactList}\small\item\em Refine an existing octree by adding a level and redistributing points attached to the tree to the boxes at the new level. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+tree\+\_\+laplace\+\_\+box\+\_\+local\+\_\+field} ({\bf wbfmm\+\_\+tree\+\_\+t} $\ast$t, guint level, guint b, gdouble $\ast$x, gdouble $\ast$f, gdouble $\ast$src, gint sstr, gdouble $\ast$normals, gint nstr, gdouble $\ast$d, gint dstr, gboolean eval\+\_\+neighbours, gdouble $\ast$work)
\begin{DoxyCompactList}\small\item\em Evaluate local Laplace field from regular expansion in box. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+tree\+\_\+laplace\+\_\+leaf\+\_\+expansions} ({\bf wbfmm\+\_\+tree\+\_\+t} $\ast$t, gdouble $\ast$src, gint sstr, gdouble $\ast$normals, gint nstr, gdouble $\ast$dipoles, gint dstr, gboolean zero\+\_\+expansions, gdouble $\ast$work)
\begin{DoxyCompactList}\small\item\em Generate leaf expansions for a tree in the Laplace problem. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+tree\+\_\+add\+\_\+points\+\_\+f} ({\bf wbfmm\+\_\+tree\+\_\+t} $\ast$t, gpointer pts, guint npts, gsize pstr)
\begin{DoxyCompactList}\small\item\em Add points to an octree. \end{DoxyCompactList}\item 
{\bf wbfmm\+\_\+tree\+\_\+t} $\ast$ {\bf wbfmm\+\_\+tree\+\_\+new\+\_\+f} (gfloat $\ast$x, gfloat D, guint maxpoints)
\begin{DoxyCompactList}\small\item\em Allocate a new octree. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+tree\+\_\+leaf\+\_\+expansions\+\_\+f} ({\bf wbfmm\+\_\+tree\+\_\+t} $\ast$t, gfloat k, gfloat $\ast$src, gint sstr, gfloat $\ast$normals, gint nstr, gfloat $\ast$dipoles, gint dstr, gboolean zero\+\_\+expansions, gfloat $\ast$work)
\begin{DoxyCompactList}\small\item\em Generate leaf expansions for a tree. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+tree\+\_\+box\+\_\+field\+\_\+f} ({\bf wbfmm\+\_\+tree\+\_\+t} $\ast$t, guint level, guint b, gfloat k, gfloat $\ast$x, gfloat $\ast$f, gint fstr, gfloat $\ast$work)
\begin{DoxyCompactList}\small\item\em Evaluate singular expansion about a box centre. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+tree\+\_\+box\+\_\+local\+\_\+field\+\_\+f} ({\bf wbfmm\+\_\+tree\+\_\+t} $\ast$t, guint level, guint b, gfloat k, gfloat $\ast$x, gfloat $\ast$f, gint fstr, gfloat $\ast$src, gint sstr, gboolean eval\+\_\+neighbours, guint field, gfloat $\ast$work)
\begin{DoxyCompactList}\small\item\em Evaluate local field from regular expansion in box. \end{DoxyCompactList}\item 
guint64 {\bf wbfmm\+\_\+point\+\_\+index\+\_\+3d\+\_\+f} (gfloat $\ast$x, gfloat $\ast$c, gfloat D)
\begin{DoxyCompactList}\small\item\em Find Morton index for point in a cubic domain. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+tree\+\_\+coefficient\+\_\+init\+\_\+f} ({\bf wbfmm\+\_\+tree\+\_\+t} $\ast$t, guint l, guint nr, guint ns)
\begin{DoxyCompactList}\small\item\em Initialize expansion coefficient data in an octree. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+tree\+\_\+refine\+\_\+f} ({\bf wbfmm\+\_\+tree\+\_\+t} $\ast$t)
\begin{DoxyCompactList}\small\item\em Refine an existing octree by adding a level and redistributing points attached to the tree to the boxes at the new level. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+tree\+\_\+laplace\+\_\+box\+\_\+local\+\_\+field\+\_\+f} ({\bf wbfmm\+\_\+tree\+\_\+t} $\ast$t, guint level, guint b, gfloat $\ast$x, gfloat $\ast$f, gfloat $\ast$src, gint sstr, gfloat $\ast$normals, gint nstr, gfloat $\ast$d, gint dstr, gboolean eval\+\_\+neighbours, gfloat $\ast$work)
\begin{DoxyCompactList}\small\item\em Evaluate local Laplace field from regular expansion in box. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+tree\+\_\+laplace\+\_\+leaf\+\_\+expansions\+\_\+f} ({\bf wbfmm\+\_\+tree\+\_\+t} $\ast$t, gfloat $\ast$src, gint sstr, gfloat $\ast$normals, gint nstr, gfloat $\ast$dipoles, gint dstr, gboolean zero\+\_\+expansions, gfloat $\ast$work)
\begin{DoxyCompactList}\small\item\em Generate leaf expansions for a tree in the Laplace problem. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+tree\+\_\+add\+\_\+level} ({\bf wbfmm\+\_\+tree\+\_\+t} $\ast$t)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Operations on octree boxes and trees. 



\subsection{Enumeration Type Documentation}
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+field\+\_\+t@{wbfmm\+\_\+field\+\_\+t}}
\index{wbfmm\+\_\+field\+\_\+t@{wbfmm\+\_\+field\+\_\+t}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+field\+\_\+t}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf wbfmm\+\_\+field\+\_\+t}}\label{group__boxes_ga72eefe6d21d0860d8c79c60291006a4e}
Selection of field to be calculated \begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{W\+B\+F\+M\+M\+\_\+\+F\+I\+E\+L\+D\+\_\+\+S\+C\+A\+L\+A\+R@{W\+B\+F\+M\+M\+\_\+\+F\+I\+E\+L\+D\+\_\+\+S\+C\+A\+L\+A\+R}!Boxes and octrees@{Boxes and octrees}}\index{Boxes and octrees@{Boxes and octrees}!W\+B\+F\+M\+M\+\_\+\+F\+I\+E\+L\+D\+\_\+\+S\+C\+A\+L\+A\+R@{W\+B\+F\+M\+M\+\_\+\+F\+I\+E\+L\+D\+\_\+\+S\+C\+A\+L\+A\+R}}\item[{\em 
W\+B\+F\+M\+M\+\_\+\+F\+I\+E\+L\+D\+\_\+\+S\+C\+A\+L\+A\+R\label{group__boxes_gga72eefe6d21d0860d8c79c60291006a4ea35ece9ea76c38c84590c74b82691b0c4}
}]scalar field \index{W\+B\+F\+M\+M\+\_\+\+F\+I\+E\+L\+D\+\_\+\+G\+R\+A\+D\+I\+E\+N\+T@{W\+B\+F\+M\+M\+\_\+\+F\+I\+E\+L\+D\+\_\+\+G\+R\+A\+D\+I\+E\+N\+T}!Boxes and octrees@{Boxes and octrees}}\index{Boxes and octrees@{Boxes and octrees}!W\+B\+F\+M\+M\+\_\+\+F\+I\+E\+L\+D\+\_\+\+G\+R\+A\+D\+I\+E\+N\+T@{W\+B\+F\+M\+M\+\_\+\+F\+I\+E\+L\+D\+\_\+\+G\+R\+A\+D\+I\+E\+N\+T}}\item[{\em 
W\+B\+F\+M\+M\+\_\+\+F\+I\+E\+L\+D\+\_\+\+G\+R\+A\+D\+I\+E\+N\+T\label{group__boxes_gga72eefe6d21d0860d8c79c60291006a4eaf7f9549d5b359762102d10c0abf13043}
}]gradient of scalar field \index{W\+B\+F\+M\+M\+\_\+\+F\+I\+E\+L\+D\+\_\+\+C\+U\+R\+L@{W\+B\+F\+M\+M\+\_\+\+F\+I\+E\+L\+D\+\_\+\+C\+U\+R\+L}!Boxes and octrees@{Boxes and octrees}}\index{Boxes and octrees@{Boxes and octrees}!W\+B\+F\+M\+M\+\_\+\+F\+I\+E\+L\+D\+\_\+\+C\+U\+R\+L@{W\+B\+F\+M\+M\+\_\+\+F\+I\+E\+L\+D\+\_\+\+C\+U\+R\+L}}\item[{\em 
W\+B\+F\+M\+M\+\_\+\+F\+I\+E\+L\+D\+\_\+\+C\+U\+R\+L\label{group__boxes_gga72eefe6d21d0860d8c79c60291006a4ea5b8f094ac70d692be60ad4dbf1dcd3a5}
}]curl of scalar field \end{description}
\end{Desc}
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+problem\+\_\+t@{wbfmm\+\_\+problem\+\_\+t}}
\index{wbfmm\+\_\+problem\+\_\+t@{wbfmm\+\_\+problem\+\_\+t}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+problem\+\_\+t}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf wbfmm\+\_\+problem\+\_\+t}}\label{group__boxes_ga543f6fd5c05c2399bf0a3625c0430552}
Selection of physical problem to be handled by a \doxyref{wbfmm\+\_\+tree\+\_\+t}{p.}{structwbfmm__tree__t} \begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{W\+B\+F\+M\+M\+\_\+\+P\+R\+O\+B\+L\+E\+M\+\_\+\+L\+A\+P\+L\+A\+C\+E@{W\+B\+F\+M\+M\+\_\+\+P\+R\+O\+B\+L\+E\+M\+\_\+\+L\+A\+P\+L\+A\+C\+E}!Boxes and octrees@{Boxes and octrees}}\index{Boxes and octrees@{Boxes and octrees}!W\+B\+F\+M\+M\+\_\+\+P\+R\+O\+B\+L\+E\+M\+\_\+\+L\+A\+P\+L\+A\+C\+E@{W\+B\+F\+M\+M\+\_\+\+P\+R\+O\+B\+L\+E\+M\+\_\+\+L\+A\+P\+L\+A\+C\+E}}\item[{\em 
W\+B\+F\+M\+M\+\_\+\+P\+R\+O\+B\+L\+E\+M\+\_\+\+L\+A\+P\+L\+A\+C\+E\label{group__boxes_gga543f6fd5c05c2399bf0a3625c0430552a5ae4679f802113e35ffc92b538d2b4ae}
}]Laplace equation \index{W\+B\+F\+M\+M\+\_\+\+P\+R\+O\+B\+L\+E\+M\+\_\+\+H\+E\+L\+M\+H\+O\+L\+T\+Z@{W\+B\+F\+M\+M\+\_\+\+P\+R\+O\+B\+L\+E\+M\+\_\+\+H\+E\+L\+M\+H\+O\+L\+T\+Z}!Boxes and octrees@{Boxes and octrees}}\index{Boxes and octrees@{Boxes and octrees}!W\+B\+F\+M\+M\+\_\+\+P\+R\+O\+B\+L\+E\+M\+\_\+\+H\+E\+L\+M\+H\+O\+L\+T\+Z@{W\+B\+F\+M\+M\+\_\+\+P\+R\+O\+B\+L\+E\+M\+\_\+\+H\+E\+L\+M\+H\+O\+L\+T\+Z}}\item[{\em 
W\+B\+F\+M\+M\+\_\+\+P\+R\+O\+B\+L\+E\+M\+\_\+\+H\+E\+L\+M\+H\+O\+L\+T\+Z\label{group__boxes_gga543f6fd5c05c2399bf0a3625c0430552a41a0eaa8074cb51d13117e09e2bbc859}
}]Helmholtz equation \end{description}
\end{Desc}


\subsection{Function Documentation}
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+point\+\_\+index\+\_\+3d@{wbfmm\+\_\+point\+\_\+index\+\_\+3d}}
\index{wbfmm\+\_\+point\+\_\+index\+\_\+3d@{wbfmm\+\_\+point\+\_\+index\+\_\+3d}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+point\+\_\+index\+\_\+3d}]{\setlength{\rightskip}{0pt plus 5cm}guint64 wbfmm\+\_\+point\+\_\+index\+\_\+3d (
\begin{DoxyParamCaption}
\item[{gdouble $\ast$}]{x, }
\item[{gdouble $\ast$}]{c, }
\item[{gdouble}]{D}
\end{DoxyParamCaption}
)}\label{group__boxes_gaf4fe54ab8180ef3460bc9283a6a5ef87}


Find Morton index for point in a cubic domain. 


\begin{DoxyParams}{Parameters}
{\em x} & point in space (three components, densely packed); \\
\hline
{\em c} & location of bottom left corner of domain; \\
\hline
{\em D} & width of domain.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+point\+\_\+index\+\_\+3d\+\_\+f@{wbfmm\+\_\+point\+\_\+index\+\_\+3d\+\_\+f}}
\index{wbfmm\+\_\+point\+\_\+index\+\_\+3d\+\_\+f@{wbfmm\+\_\+point\+\_\+index\+\_\+3d\+\_\+f}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+point\+\_\+index\+\_\+3d\+\_\+f}]{\setlength{\rightskip}{0pt plus 5cm}guint64 wbfmm\+\_\+point\+\_\+index\+\_\+3d\+\_\+f (
\begin{DoxyParamCaption}
\item[{gfloat $\ast$}]{x, }
\item[{gfloat $\ast$}]{c, }
\item[{gfloat}]{D}
\end{DoxyParamCaption}
)}\label{group__boxes_gaed9d494a72a7a808860cd38da5f3c47b}


Find Morton index for point in a cubic domain. 


\begin{DoxyParams}{Parameters}
{\em x} & point in space (three components, densely packed); \\
\hline
{\em c} & location of bottom left corner of domain; \\
\hline
{\em D} & width of domain.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+tree\+\_\+add\+\_\+level@{wbfmm\+\_\+tree\+\_\+add\+\_\+level}}
\index{wbfmm\+\_\+tree\+\_\+add\+\_\+level@{wbfmm\+\_\+tree\+\_\+add\+\_\+level}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+tree\+\_\+add\+\_\+level}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+tree\+\_\+add\+\_\+level (
\begin{DoxyParamCaption}
\item[{{\bf wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t}
\end{DoxyParamCaption}
)}\label{group__boxes_gadd47ecc4ffa77feb9313661010541c3e}
Add a new level to an existing octree. The function assigns memory for, and initializes, a new layer of boxes of type \doxyref{wbfmm\+\_\+box\+\_\+t}{p.}{structwbfmm__box__t}


\begin{DoxyParams}{Parameters}
{\em t} & an existing \doxyref{wbfmm\+\_\+tree\+\_\+t}{p.}{structwbfmm__tree__t}\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success. 
\end{DoxyReturn}


References wbfmm\+\_\+tree\+\_\+t\+::boxes, and wbfmm\+\_\+tree\+\_\+t\+::depth.

\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+tree\+\_\+add\+\_\+points@{wbfmm\+\_\+tree\+\_\+add\+\_\+points}}
\index{wbfmm\+\_\+tree\+\_\+add\+\_\+points@{wbfmm\+\_\+tree\+\_\+add\+\_\+points}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+tree\+\_\+add\+\_\+points}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+tree\+\_\+add\+\_\+points (
\begin{DoxyParamCaption}
\item[{{\bf wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t, }
\item[{gpointer}]{pts, }
\item[{guint}]{npts, }
\item[{gsize}]{pstr}
\end{DoxyParamCaption}
)}\label{group__boxes_ga0880268a175e624f6dab06dd2c4dc5bc}


Add points to an octree. 

Add a set of source points to an octree. The points are assumed to be in an array of real values with components in a packed triple, indexed using a stride of pstr bytes (this allows for quite general handling of different source formats).


\begin{DoxyParams}{Parameters}
{\em t} & an existing \doxyref{wbfmm\+\_\+tree\+\_\+t}{p.}{structwbfmm__tree__t}; \\
\hline
{\em pts} & an array containing point coordinates; \\
\hline
{\em npts} & the number of points in {\itshape pts}; \\
\hline
{\em pstr} & stride between points in bytes.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success. 
\end{DoxyReturn}
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+tree\+\_\+add\+\_\+points\+\_\+f@{wbfmm\+\_\+tree\+\_\+add\+\_\+points\+\_\+f}}
\index{wbfmm\+\_\+tree\+\_\+add\+\_\+points\+\_\+f@{wbfmm\+\_\+tree\+\_\+add\+\_\+points\+\_\+f}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+tree\+\_\+add\+\_\+points\+\_\+f}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+tree\+\_\+add\+\_\+points\+\_\+f (
\begin{DoxyParamCaption}
\item[{{\bf wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t, }
\item[{gpointer}]{pts, }
\item[{guint}]{npts, }
\item[{gsize}]{pstr}
\end{DoxyParamCaption}
)}\label{group__boxes_gaa555067e43de3f96cdc7c2b912908eee}


Add points to an octree. 

Add a set of source points to an octree. The points are assumed to be in an array of real values with components in a packed triple, indexed using a stride of pstr bytes (this allows for quite general handling of different source formats).


\begin{DoxyParams}{Parameters}
{\em t} & an existing \doxyref{wbfmm\+\_\+tree\+\_\+t}{p.}{structwbfmm__tree__t}; \\
\hline
{\em pts} & an array containing point coordinates; \\
\hline
{\em npts} & the number of points in {\itshape pts}; \\
\hline
{\em pstr} & stride between points in bytes.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success. 
\end{DoxyReturn}
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+tree\+\_\+box\+\_\+field@{wbfmm\+\_\+tree\+\_\+box\+\_\+field}}
\index{wbfmm\+\_\+tree\+\_\+box\+\_\+field@{wbfmm\+\_\+tree\+\_\+box\+\_\+field}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+tree\+\_\+box\+\_\+field}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+tree\+\_\+box\+\_\+field (
\begin{DoxyParamCaption}
\item[{{\bf wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t, }
\item[{guint}]{level, }
\item[{guint}]{b, }
\item[{gdouble}]{k, }
\item[{gdouble $\ast$}]{x, }
\item[{gdouble $\ast$}]{f, }
\item[{gint}]{fstr, }
\item[{gdouble $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__boxes_ga252f8fa31681dbdf2b0cc25779d9321b}


Evaluate singular expansion about a box centre. 


\begin{DoxyParams}{Parameters}
{\em t} & octree for problem; \\
\hline
{\em level} & level in {\itshape t}; \\
\hline
{\em b} & index of box at level {\itshape level} of {\itshape t}; \\
\hline
{\em k} & wavenumber; \\
\hline
{\em x} & field evaluation point; \\
\hline
{\em f} & on output field at {\itshape x} (not zeroed before evaluation); \\
\hline
{\em fstr} & stride in {\itshape field} in number of array entries; \\
\hline
{\em work} & workspace\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+tree\+\_\+box\+\_\+field\+\_\+f@{wbfmm\+\_\+tree\+\_\+box\+\_\+field\+\_\+f}}
\index{wbfmm\+\_\+tree\+\_\+box\+\_\+field\+\_\+f@{wbfmm\+\_\+tree\+\_\+box\+\_\+field\+\_\+f}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+tree\+\_\+box\+\_\+field\+\_\+f}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+tree\+\_\+box\+\_\+field\+\_\+f (
\begin{DoxyParamCaption}
\item[{{\bf wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t, }
\item[{guint}]{level, }
\item[{guint}]{b, }
\item[{gfloat}]{k, }
\item[{gfloat $\ast$}]{x, }
\item[{gfloat $\ast$}]{f, }
\item[{gint}]{fstr, }
\item[{gfloat $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__boxes_gaeabd371c311cc5378faaa8ad2cee864c}


Evaluate singular expansion about a box centre. 


\begin{DoxyParams}{Parameters}
{\em t} & octree for problem; \\
\hline
{\em level} & level in {\itshape t}; \\
\hline
{\em b} & index of box at level {\itshape level} of {\itshape t}; \\
\hline
{\em k} & wavenumber; \\
\hline
{\em x} & field evaluation point; \\
\hline
{\em f} & on output field at {\itshape x} (not zeroed before evaluation); \\
\hline
{\em fstr} & stride in {\itshape field} in number of array entries; \\
\hline
{\em work} & workspace\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+tree\+\_\+box\+\_\+local\+\_\+field@{wbfmm\+\_\+tree\+\_\+box\+\_\+local\+\_\+field}}
\index{wbfmm\+\_\+tree\+\_\+box\+\_\+local\+\_\+field@{wbfmm\+\_\+tree\+\_\+box\+\_\+local\+\_\+field}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+tree\+\_\+box\+\_\+local\+\_\+field}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+tree\+\_\+box\+\_\+local\+\_\+field (
\begin{DoxyParamCaption}
\item[{{\bf wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t, }
\item[{guint}]{level, }
\item[{guint}]{b, }
\item[{gdouble}]{k, }
\item[{gdouble $\ast$}]{x, }
\item[{gdouble $\ast$}]{f, }
\item[{gint}]{fstr, }
\item[{gdouble $\ast$}]{src, }
\item[{gint}]{sstr, }
\item[{gboolean}]{eval\+\_\+neighbours, }
\item[{guint}]{field, }
\item[{gdouble $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__boxes_ga30fed6f06740bcad070aadaf1f499865}


Evaluate local field from regular expansion in box. 


\begin{DoxyParams}{Parameters}
{\em t} & octree for domain; \\
\hline
{\em level} & level of {\itshape t}; \\
\hline
{\em b} & box index at level {\itshape level} of {\itshape t}; \\
\hline
{\em k} & wavenumber; \\
\hline
{\em x} & location of evaluation point; \\
\hline
{\em f} & on output, field value (not zeroed before evaluation); \\
\hline
{\em fstr} & stride of data in {\itshape f}; \\
\hline
{\em src} & source strengths; \\
\hline
{\em sstr} & stride of data in {\itshape src}; \\
\hline
{\em eval\+\_\+neighbours} & if T\+R\+U\+E compute contributions from sources in box {\itshape b} and neighbours; \\
\hline
{\em field} & X\+O\+R combination of \doxyref{wbfmm\+\_\+field\+\_\+t}{p.}{group__boxes_ga72eefe6d21d0860d8c79c60291006a4e} to select output field type (scalar, gradient, curl, etc.); \\
\hline
{\em work} & workspace.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+tree\+\_\+box\+\_\+local\+\_\+field\+\_\+f@{wbfmm\+\_\+tree\+\_\+box\+\_\+local\+\_\+field\+\_\+f}}
\index{wbfmm\+\_\+tree\+\_\+box\+\_\+local\+\_\+field\+\_\+f@{wbfmm\+\_\+tree\+\_\+box\+\_\+local\+\_\+field\+\_\+f}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+tree\+\_\+box\+\_\+local\+\_\+field\+\_\+f}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+tree\+\_\+box\+\_\+local\+\_\+field\+\_\+f (
\begin{DoxyParamCaption}
\item[{{\bf wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t, }
\item[{guint}]{level, }
\item[{guint}]{b, }
\item[{gfloat}]{k, }
\item[{gfloat $\ast$}]{x, }
\item[{gfloat $\ast$}]{f, }
\item[{gint}]{fstr, }
\item[{gfloat $\ast$}]{src, }
\item[{gint}]{sstr, }
\item[{gboolean}]{eval\+\_\+neighbours, }
\item[{guint}]{field, }
\item[{gfloat $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__boxes_gaea123d47e282266840fa39af0866f433}


Evaluate local field from regular expansion in box. 


\begin{DoxyParams}{Parameters}
{\em t} & octree for domain; \\
\hline
{\em level} & level of {\itshape t}; \\
\hline
{\em b} & box index at level {\itshape level} of {\itshape t}; \\
\hline
{\em k} & wavenumber; \\
\hline
{\em x} & location of evaluation point; \\
\hline
{\em f} & on output, field value (not zeroed before evaluation); \\
\hline
{\em fstr} & stride of data in {\itshape f}; \\
\hline
{\em src} & source strengths; \\
\hline
{\em sstr} & stride of data in {\itshape src}; \\
\hline
{\em eval\+\_\+neighbours} & if T\+R\+U\+E compute contributions from sources in box {\itshape b} and neighbours; \\
\hline
{\em field} & X\+O\+R combination of \doxyref{wbfmm\+\_\+field\+\_\+t}{p.}{group__boxes_ga72eefe6d21d0860d8c79c60291006a4e} to select output field type (scalar, gradient, curl, etc.); \\
\hline
{\em work} & workspace.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+tree\+\_\+coefficient\+\_\+init@{wbfmm\+\_\+tree\+\_\+coefficient\+\_\+init}}
\index{wbfmm\+\_\+tree\+\_\+coefficient\+\_\+init@{wbfmm\+\_\+tree\+\_\+coefficient\+\_\+init}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+tree\+\_\+coefficient\+\_\+init}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+tree\+\_\+coefficient\+\_\+init (
\begin{DoxyParamCaption}
\item[{{\bf wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t, }
\item[{guint}]{l, }
\item[{guint}]{nr, }
\item[{guint}]{ns}
\end{DoxyParamCaption}
)}\label{group__boxes_ga091c6f775fa64cd58db004fbb18995c8}


Initialize expansion coefficient data in an octree. 


\begin{DoxyParams}{Parameters}
{\em t} & octree for problem; \\
\hline
{\em l} & level to initialize data for; \\
\hline
{\em nr} & order of regular expansions at level {\itshape l}; \\
\hline
{\em ns} & order of singular expansions at level {\itshape l}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+tree\+\_\+coefficient\+\_\+init\+\_\+f@{wbfmm\+\_\+tree\+\_\+coefficient\+\_\+init\+\_\+f}}
\index{wbfmm\+\_\+tree\+\_\+coefficient\+\_\+init\+\_\+f@{wbfmm\+\_\+tree\+\_\+coefficient\+\_\+init\+\_\+f}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+tree\+\_\+coefficient\+\_\+init\+\_\+f}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+tree\+\_\+coefficient\+\_\+init\+\_\+f (
\begin{DoxyParamCaption}
\item[{{\bf wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t, }
\item[{guint}]{l, }
\item[{guint}]{nr, }
\item[{guint}]{ns}
\end{DoxyParamCaption}
)}\label{group__boxes_ga4332e5e154107afd81e9810465975460}


Initialize expansion coefficient data in an octree. 


\begin{DoxyParams}{Parameters}
{\em t} & octree for problem; \\
\hline
{\em l} & level to initialize data for; \\
\hline
{\em nr} & order of regular expansions at level {\itshape l}; \\
\hline
{\em ns} & order of singular expansions at level {\itshape l}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+tree\+\_\+laplace\+\_\+box\+\_\+local\+\_\+field@{wbfmm\+\_\+tree\+\_\+laplace\+\_\+box\+\_\+local\+\_\+field}}
\index{wbfmm\+\_\+tree\+\_\+laplace\+\_\+box\+\_\+local\+\_\+field@{wbfmm\+\_\+tree\+\_\+laplace\+\_\+box\+\_\+local\+\_\+field}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+tree\+\_\+laplace\+\_\+box\+\_\+local\+\_\+field}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+tree\+\_\+laplace\+\_\+box\+\_\+local\+\_\+field (
\begin{DoxyParamCaption}
\item[{{\bf wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t, }
\item[{guint}]{level, }
\item[{guint}]{b, }
\item[{gdouble $\ast$}]{x, }
\item[{gdouble $\ast$}]{f, }
\item[{gdouble $\ast$}]{src, }
\item[{gint}]{sstr, }
\item[{gdouble $\ast$}]{normals, }
\item[{gint}]{nstr, }
\item[{gdouble $\ast$}]{d, }
\item[{gint}]{dstr, }
\item[{gboolean}]{eval\+\_\+neighbours, }
\item[{gdouble $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__boxes_ga86787ea2121b4d3fea7b8c258c75c8ae}


Evaluate local Laplace field from regular expansion in box. 


\begin{DoxyParams}{Parameters}
{\em t} & octree for domain; \\
\hline
{\em level} & level of {\itshape t}; \\
\hline
{\em b} & box index at level {\itshape level} of {\itshape t}; \\
\hline
{\em x} & location of evaluation point; \\
\hline
{\em f} & on output, field value (not zeroed before evaluation); \\
\hline
{\em src} & source strengths; \\
\hline
{\em sstr} & stride of data in {\itshape src}; \\
\hline
{\em normals} & normals for dipole sources; \\
\hline
{\em nstr} & stride in {\itshape normals}; \\
\hline
{\em d} & dipole source strengths, or dipole vectors; \\
\hline
{\em dstr} & stride in {\itshape d}; \\
\hline
{\em eval\+\_\+neighbours} & if T\+R\+U\+E compute contributions from sources in box {\itshape b} and neighbours; \\
\hline
{\em work} & workspace.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+tree\+\_\+laplace\+\_\+box\+\_\+local\+\_\+field\+\_\+f@{wbfmm\+\_\+tree\+\_\+laplace\+\_\+box\+\_\+local\+\_\+field\+\_\+f}}
\index{wbfmm\+\_\+tree\+\_\+laplace\+\_\+box\+\_\+local\+\_\+field\+\_\+f@{wbfmm\+\_\+tree\+\_\+laplace\+\_\+box\+\_\+local\+\_\+field\+\_\+f}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+tree\+\_\+laplace\+\_\+box\+\_\+local\+\_\+field\+\_\+f}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+tree\+\_\+laplace\+\_\+box\+\_\+local\+\_\+field\+\_\+f (
\begin{DoxyParamCaption}
\item[{{\bf wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t, }
\item[{guint}]{level, }
\item[{guint}]{b, }
\item[{gfloat $\ast$}]{x, }
\item[{gfloat $\ast$}]{f, }
\item[{gfloat $\ast$}]{src, }
\item[{gint}]{sstr, }
\item[{gfloat $\ast$}]{normals, }
\item[{gint}]{nstr, }
\item[{gfloat $\ast$}]{d, }
\item[{gint}]{dstr, }
\item[{gboolean}]{eval\+\_\+neighbours, }
\item[{gfloat $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__boxes_gabfdf2b25b90f3701088aa9b3ba21cf78}


Evaluate local Laplace field from regular expansion in box. 


\begin{DoxyParams}{Parameters}
{\em t} & octree for domain; \\
\hline
{\em level} & level of {\itshape t}; \\
\hline
{\em b} & box index at level {\itshape level} of {\itshape t}; \\
\hline
{\em x} & location of evaluation point; \\
\hline
{\em f} & on output, field value (not zeroed before evaluation); \\
\hline
{\em src} & source strengths; \\
\hline
{\em sstr} & stride of data in {\itshape src}; \\
\hline
{\em normals} & normals for dipole sources; \\
\hline
{\em nstr} & stride in {\itshape normals}; \\
\hline
{\em d} & dipole source strengths, or dipole vectors; \\
\hline
{\em dstr} & stride in {\itshape d}; \\
\hline
{\em eval\+\_\+neighbours} & if T\+R\+U\+E compute contributions from sources in box {\itshape b} and neighbours; \\
\hline
{\em work} & workspace.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+tree\+\_\+laplace\+\_\+leaf\+\_\+expansions@{wbfmm\+\_\+tree\+\_\+laplace\+\_\+leaf\+\_\+expansions}}
\index{wbfmm\+\_\+tree\+\_\+laplace\+\_\+leaf\+\_\+expansions@{wbfmm\+\_\+tree\+\_\+laplace\+\_\+leaf\+\_\+expansions}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+tree\+\_\+laplace\+\_\+leaf\+\_\+expansions}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+tree\+\_\+laplace\+\_\+leaf\+\_\+expansions (
\begin{DoxyParamCaption}
\item[{{\bf wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t, }
\item[{gdouble $\ast$}]{src, }
\item[{gint}]{sstr, }
\item[{gdouble $\ast$}]{normals, }
\item[{gint}]{nstr, }
\item[{gdouble $\ast$}]{dipoles, }
\item[{gint}]{dstr, }
\item[{gboolean}]{zero\+\_\+expansions, }
\item[{gdouble $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__boxes_ga00f1078aec5a2ff428878cb83e1cf48e}


Generate leaf expansions for a tree in the Laplace problem. 

Generate leaf expansions for a tree for the Laplace problem given some combination of monopole and dipole sources. Source positions are those in the point list attached to the tree using \doxyref{wbfmm\+\_\+tree\+\_\+add\+\_\+points}{p.}{group__boxes_ga0880268a175e624f6dab06dd2c4dc5bc}(...) and indexing in the array must correspond to that in the point list. Input arrays may be N\+U\+L\+L\+: if {\itshape src} is not N\+U\+L\+L, it is interpreted as a list of monopole strengths; if {\itshape normals} is not N\+U\+L\+L, {\itshape dipoles} may not be N\+U\+L\+L and they are interpreted respectively as a vector (`normal\textquotesingle{}) at each source position and a scalar amplitude (this corresponds to surface normal and a normal velocity amplitude in a boundary element method calculation); if {\itshape normals} is N\+U\+L\+L and {\itshape dipoles} is not N\+U\+L\+L, {\itshape dipoles} is interpreted as a three-\/element vector specifying the dipole strength. The strides {\itshape sstr}, {\itshape nstr}, and {\itshape dstr} are the number of scalar elements between successive entries in the arrays, with the elements of each entry densely packed. For example, a list of normals might read\+:

$[n_{x1}\quad n_{y1}\quad n_{z1}\quad a_{1}\quad b_{1}\quad n_{x2} \ldots]$

where $(n_{x1},n_{y1},n_{z1})$ is the first normal vector and $a_{1}$ and $b_{1}$ are arbitrary entries in the array. In this case, the stride {\itshape nstr} would be 5, the number of elements between successive values of $n_{xi}$.


\begin{DoxyParams}{Parameters}
{\em t} & octree for problem; \\
\hline
{\em src} & monopole source strengths; \\
\hline
{\em sstr} & stride of data in {\itshape src}; \\
\hline
{\em normals} & dipole normals; \\
\hline
{\em nstr} & stride of data in {\itshape normals}; \\
\hline
{\em dipoles} & dipole source strengths (if {\itshape normals} is not N\+U\+L\+L), or moment vectors (if {\itshape normals} is N\+U\+L\+L); \\
\hline
{\em dstr} & stride of data in {\itshape dipoles}; \\
\hline
{\em zero\+\_\+expansions} & if T\+R\+U\+E, set expansion coefficients to zero before adding source terms; \\
\hline
{\em work} & workspace.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+tree\+\_\+laplace\+\_\+leaf\+\_\+expansions\+\_\+f@{wbfmm\+\_\+tree\+\_\+laplace\+\_\+leaf\+\_\+expansions\+\_\+f}}
\index{wbfmm\+\_\+tree\+\_\+laplace\+\_\+leaf\+\_\+expansions\+\_\+f@{wbfmm\+\_\+tree\+\_\+laplace\+\_\+leaf\+\_\+expansions\+\_\+f}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+tree\+\_\+laplace\+\_\+leaf\+\_\+expansions\+\_\+f}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+tree\+\_\+laplace\+\_\+leaf\+\_\+expansions\+\_\+f (
\begin{DoxyParamCaption}
\item[{{\bf wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t, }
\item[{gfloat $\ast$}]{src, }
\item[{gint}]{sstr, }
\item[{gfloat $\ast$}]{normals, }
\item[{gint}]{nstr, }
\item[{gfloat $\ast$}]{dipoles, }
\item[{gint}]{dstr, }
\item[{gboolean}]{zero\+\_\+expansions, }
\item[{gfloat $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__boxes_ga5c5fdc5398d73ef19d9c55a7ce150f91}


Generate leaf expansions for a tree in the Laplace problem. 

Generate leaf expansions for a tree for the Laplace problem given some combination of monopole and dipole sources. Source positions are those in the point list attached to the tree using \doxyref{wbfmm\+\_\+tree\+\_\+add\+\_\+points\+\_\+f}{p.}{group__boxes_gaa555067e43de3f96cdc7c2b912908eee}(...) and indexing in the array must correspond to that in the point list. Input arrays may be N\+U\+L\+L\+: if {\itshape src} is not N\+U\+L\+L, it is interpreted as a list of monopole strengths; if {\itshape normals} is not N\+U\+L\+L, {\itshape dipoles} may not be N\+U\+L\+L and they are interpreted respectively as a vector (`normal\textquotesingle{}) at each source position and a scalar amplitude (this corresponds to surface normal and a normal velocity amplitude in a boundary element method calculation); if {\itshape normals} is N\+U\+L\+L and {\itshape dipoles} is not N\+U\+L\+L, {\itshape dipoles} is interpreted as a three-\/element vector specifying the dipole strength. The strides {\itshape sstr}, {\itshape nstr}, and {\itshape dstr} are the number of scalar elements between successive entries in the arrays, with the elements of each entry densely packed. For example, a list of normals might read\+:

$[n_{x1}\quad n_{y1}\quad n_{z1}\quad a_{1}\quad b_{1}\quad n_{x2} \ldots]$

where $(n_{x1},n_{y1},n_{z1})$ is the first normal vector and $a_{1}$ and $b_{1}$ are arbitrary entries in the array. In this case, the stride {\itshape nstr} would be 5, the number of elements between successive values of $n_{xi}$.


\begin{DoxyParams}{Parameters}
{\em t} & octree for problem; \\
\hline
{\em src} & monopole source strengths; \\
\hline
{\em sstr} & stride of data in {\itshape src}; \\
\hline
{\em normals} & dipole normals; \\
\hline
{\em nstr} & stride of data in {\itshape normals}; \\
\hline
{\em dipoles} & dipole source strengths (if {\itshape normals} is not N\+U\+L\+L), or moment vectors (if {\itshape normals} is N\+U\+L\+L); \\
\hline
{\em dstr} & stride of data in {\itshape dipoles}; \\
\hline
{\em zero\+\_\+expansions} & if T\+R\+U\+E, set expansion coefficients to zero before adding source terms; \\
\hline
{\em work} & workspace.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+tree\+\_\+leaf\+\_\+expansions@{wbfmm\+\_\+tree\+\_\+leaf\+\_\+expansions}}
\index{wbfmm\+\_\+tree\+\_\+leaf\+\_\+expansions@{wbfmm\+\_\+tree\+\_\+leaf\+\_\+expansions}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+tree\+\_\+leaf\+\_\+expansions}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+tree\+\_\+leaf\+\_\+expansions (
\begin{DoxyParamCaption}
\item[{{\bf wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t, }
\item[{gdouble}]{k, }
\item[{gdouble $\ast$}]{src, }
\item[{gint}]{sstr, }
\item[{gdouble $\ast$}]{normals, }
\item[{gint}]{nstr, }
\item[{gdouble $\ast$}]{dipoles, }
\item[{gint}]{dstr, }
\item[{gboolean}]{zero\+\_\+expansions, }
\item[{gdouble $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__boxes_gacff456ef3d99c08c93be852ec781aa2a}


Generate leaf expansions for a tree. 

Generate leaf expansions for a tree given some combination of monopole and dipole sources. Source positions are those in the point list attached to the tree using \doxyref{wbfmm\+\_\+tree\+\_\+add\+\_\+points}{p.}{group__boxes_ga0880268a175e624f6dab06dd2c4dc5bc}(...) and indexing in the array must correspond to that in the point list. Input arrays may be N\+U\+L\+L\+: if {\itshape src} is not N\+U\+L\+L, it is interpreted as a list of complex monopole strengths; if {\itshape normals} is not N\+U\+L\+L, {\itshape dipoles} may not be N\+U\+L\+L and they are interpreted respectively as a vector (`normal\textquotesingle{}) at each source position and a scalar complex amplitude (this corresponds to surface normal and a normal velocity amplitude in a boundary element method calculation); if {\itshape normals} is N\+U\+L\+L and {\itshape dipoles} is not N\+U\+L\+L, {\itshape dipoles} is interpreted as a three-\/element complex vector specifying the dipole strength. The strides {\itshape sstr}, {\itshape nstr}, and {\itshape dstr} are the number of scalar elements between successive entries in the arrays, with the elements of each entry densely packed. For example, a list of normals might read\+:

$[n_{x1}\quad n_{y1}\quad n_{z1}\quad a_{1}\quad b_{1}\quad n_{x2} \ldots]$

where $(n_{x1},n_{y1},n_{z1})$ is the first normal vector and $a_{1}$ and $b_{1}$ are arbitrary entries in the array. In this case, the stride {\itshape nstr} would be 5, the number of elements between successive values of $n_{xi}$.


\begin{DoxyParams}{Parameters}
{\em t} & octree for problem; \\
\hline
{\em k} & wavenumber; \\
\hline
{\em src} & monopole source strengths; \\
\hline
{\em sstr} & stride of data in {\itshape src}; \\
\hline
{\em normals} & dipole normals; \\
\hline
{\em nstr} & stride of data in {\itshape normals}; \\
\hline
{\em dipoles} & dipole source strengths (if {\itshape normals} is not N\+U\+L\+L), or moment vectors (if {\itshape normals} is N\+U\+L\+L); \\
\hline
{\em dstr} & stride of data in {\itshape dipoles}; \\
\hline
{\em zero\+\_\+expansions} & if T\+R\+U\+E, set expansion coefficients to zero before adding source terms; \\
\hline
{\em work} & workspace.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+tree\+\_\+leaf\+\_\+expansions\+\_\+f@{wbfmm\+\_\+tree\+\_\+leaf\+\_\+expansions\+\_\+f}}
\index{wbfmm\+\_\+tree\+\_\+leaf\+\_\+expansions\+\_\+f@{wbfmm\+\_\+tree\+\_\+leaf\+\_\+expansions\+\_\+f}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+tree\+\_\+leaf\+\_\+expansions\+\_\+f}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+tree\+\_\+leaf\+\_\+expansions\+\_\+f (
\begin{DoxyParamCaption}
\item[{{\bf wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t, }
\item[{gfloat}]{k, }
\item[{gfloat $\ast$}]{src, }
\item[{gint}]{sstr, }
\item[{gfloat $\ast$}]{normals, }
\item[{gint}]{nstr, }
\item[{gfloat $\ast$}]{dipoles, }
\item[{gint}]{dstr, }
\item[{gboolean}]{zero\+\_\+expansions, }
\item[{gfloat $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__boxes_ga0fe2ee1d112ae2f61ebf75f36f4e0698}


Generate leaf expansions for a tree. 

Generate leaf expansions for a tree given some combination of monopole and dipole sources. Source positions are those in the point list attached to the tree using \doxyref{wbfmm\+\_\+tree\+\_\+add\+\_\+points\+\_\+f}{p.}{group__boxes_gaa555067e43de3f96cdc7c2b912908eee}(...) and indexing in the array must correspond to that in the point list. Input arrays may be N\+U\+L\+L\+: if {\itshape src} is not N\+U\+L\+L, it is interpreted as a list of complex monopole strengths; if {\itshape normals} is not N\+U\+L\+L, {\itshape dipoles} may not be N\+U\+L\+L and they are interpreted respectively as a vector (`normal\textquotesingle{}) at each source position and a scalar complex amplitude (this corresponds to surface normal and a normal velocity amplitude in a boundary element method calculation); if {\itshape normals} is N\+U\+L\+L and {\itshape dipoles} is not N\+U\+L\+L, {\itshape dipoles} is interpreted as a three-\/element complex vector specifying the dipole strength. The strides {\itshape sstr}, {\itshape nstr}, and {\itshape dstr} are the number of scalar elements between successive entries in the arrays, with the elements of each entry densely packed. For example, a list of normals might read\+:

$[n_{x1}\quad n_{y1}\quad n_{z1}\quad a_{1}\quad b_{1}\quad n_{x2} \ldots]$

where $(n_{x1},n_{y1},n_{z1})$ is the first normal vector and $a_{1}$ and $b_{1}$ are arbitrary entries in the array. In this case, the stride {\itshape nstr} would be 5, the number of elements between successive values of $n_{xi}$.


\begin{DoxyParams}{Parameters}
{\em t} & octree for problem; \\
\hline
{\em k} & wavenumber; \\
\hline
{\em src} & monopole source strengths; \\
\hline
{\em sstr} & stride of data in {\itshape src}; \\
\hline
{\em normals} & dipole normals; \\
\hline
{\em nstr} & stride of data in {\itshape normals}; \\
\hline
{\em dipoles} & dipole source strengths (if {\itshape normals} is not N\+U\+L\+L), or moment vectors (if {\itshape normals} is N\+U\+L\+L); \\
\hline
{\em dstr} & stride of data in {\itshape dipoles}; \\
\hline
{\em zero\+\_\+expansions} & if T\+R\+U\+E, set expansion coefficients to zero before adding source terms; \\
\hline
{\em work} & workspace.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+tree\+\_\+new@{wbfmm\+\_\+tree\+\_\+new}}
\index{wbfmm\+\_\+tree\+\_\+new@{wbfmm\+\_\+tree\+\_\+new}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+tree\+\_\+new}]{\setlength{\rightskip}{0pt plus 5cm}{\bf wbfmm\+\_\+tree\+\_\+t}$\ast$ wbfmm\+\_\+tree\+\_\+new (
\begin{DoxyParamCaption}
\item[{gdouble $\ast$}]{x, }
\item[{gdouble}]{D, }
\item[{guint}]{maxpoints}
\end{DoxyParamCaption}
)}\label{group__boxes_gac9dfbda09294662f66da14d5c825f669}


Allocate a new octree. 


\begin{DoxyParams}{Parameters}
{\em x} & location of origin of tree; \\
\hline
{\em D} & width of domain; \\
\hline
{\em maxpoints} & maximum number of source points in tree.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
pointer to newly allocated tree. 
\end{DoxyReturn}
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+tree\+\_\+new\+\_\+f@{wbfmm\+\_\+tree\+\_\+new\+\_\+f}}
\index{wbfmm\+\_\+tree\+\_\+new\+\_\+f@{wbfmm\+\_\+tree\+\_\+new\+\_\+f}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+tree\+\_\+new\+\_\+f}]{\setlength{\rightskip}{0pt plus 5cm}{\bf wbfmm\+\_\+tree\+\_\+t}$\ast$ wbfmm\+\_\+tree\+\_\+new\+\_\+f (
\begin{DoxyParamCaption}
\item[{gfloat $\ast$}]{x, }
\item[{gfloat}]{D, }
\item[{guint}]{maxpoints}
\end{DoxyParamCaption}
)}\label{group__boxes_ga991ae5108a827b4020309d4d21ede230}


Allocate a new octree. 


\begin{DoxyParams}{Parameters}
{\em x} & location of origin of tree; \\
\hline
{\em D} & width of domain; \\
\hline
{\em maxpoints} & maximum number of source points in tree.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
pointer to newly allocated tree. 
\end{DoxyReturn}
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+tree\+\_\+refine@{wbfmm\+\_\+tree\+\_\+refine}}
\index{wbfmm\+\_\+tree\+\_\+refine@{wbfmm\+\_\+tree\+\_\+refine}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+tree\+\_\+refine}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+tree\+\_\+refine (
\begin{DoxyParamCaption}
\item[{{\bf wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t}
\end{DoxyParamCaption}
)}\label{group__boxes_ga6662da7d3ec452d58201d0a6464286e4}


Refine an existing octree by adding a level and redistributing points attached to the tree to the boxes at the new level. 


\begin{DoxyParams}{Parameters}
{\em t} & an existing \doxyref{wbfmm\+\_\+tree\+\_\+t}{p.}{structwbfmm__tree__t}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success. 
\end{DoxyReturn}
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\+\_\+tree\+\_\+refine\+\_\+f@{wbfmm\+\_\+tree\+\_\+refine\+\_\+f}}
\index{wbfmm\+\_\+tree\+\_\+refine\+\_\+f@{wbfmm\+\_\+tree\+\_\+refine\+\_\+f}!Boxes and octrees@{Boxes and octrees}}
\subsubsection[{wbfmm\+\_\+tree\+\_\+refine\+\_\+f}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+tree\+\_\+refine\+\_\+f (
\begin{DoxyParamCaption}
\item[{{\bf wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t}
\end{DoxyParamCaption}
)}\label{group__boxes_gac6bccb17227a1d01d8aa1d38c09223c3}


Refine an existing octree by adding a level and redistributing points attached to the tree to the boxes at the new level. 


\begin{DoxyParams}{Parameters}
{\em t} & an existing \doxyref{wbfmm\+\_\+tree\+\_\+t}{p.}{structwbfmm__tree__t}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success. 
\end{DoxyReturn}
