\doxysection{Boxes and octrees}
\label{group__boxes}\index{Boxes and octrees@{Boxes and octrees}}


Operations on octree boxes and trees.  


\doxysubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \textbf{ wbfmm\+\_\+box\+\_\+t}
\item 
struct \textbf{ wbfmm\+\_\+tree\+\_\+t}
\item 
struct \textbf{ wbfmm\+\_\+target\+\_\+list\+\_\+t}
\item 
struct \textbf{ wbfmm\+\_\+shift\+\_\+operators\+\_\+t}
\end{DoxyCompactItemize}
\doxysubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \textbf{ wbfmm\+\_\+problem\+\_\+t} \{ \textbf{ WBFMM\+\_\+\+PROBLEM\+\_\+\+LAPLACE} = 1
, \textbf{ WBFMM\+\_\+\+PROBLEM\+\_\+\+HELMHOLTZ} = 2
 \}
\item 
enum \textbf{ wbfmm\+\_\+field\+\_\+t} \{ \textbf{ WBFMM\+\_\+\+FIELD\+\_\+\+SCALAR} = 1 $<$$<$ 0
, \textbf{ WBFMM\+\_\+\+FIELD\+\_\+\+GRADIENT} = 1 $<$$<$ 1
, \textbf{ WBFMM\+\_\+\+FIELD\+\_\+\+CURL} = 1 $<$$<$ 2
 \}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
gint \textbf{ wbfmm\+\_\+tree\+\_\+add\+\_\+points} (\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$t, gpointer pts, gsize pstr, gpointer normals, gsize nstr, guint npts, gboolean sorted)
\begin{DoxyCompactList}\small\item\em Add points to an octree. \end{DoxyCompactList}\item 
\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$ \textbf{ wbfmm\+\_\+tree\+\_\+new} (gdouble $\ast$x, gdouble D, guint maxpoints)
\begin{DoxyCompactList}\small\item\em Allocate a new octree. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+tree\+\_\+leaf\+\_\+expansions} (\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$t, gdouble k, gdouble $\ast$src, gint sstr, gdouble $\ast$normals, gint nstr, gdouble $\ast$dipoles, gint dstr, gboolean zero\+\_\+expansions, gdouble $\ast$work)
\begin{DoxyCompactList}\small\item\em Generate leaf expansions for a tree. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+tree\+\_\+box\+\_\+field} (\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$t, guint level, guint b, gdouble k, gdouble $\ast$x, gdouble $\ast$f, gint fstr, gdouble $\ast$work)
\begin{DoxyCompactList}\small\item\em Evaluate singular expansion about a box centre. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+tree\+\_\+box\+\_\+local\+\_\+field} (\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$t, guint level, guint b, gdouble k, gdouble $\ast$x, gdouble $\ast$f, gint fstr, gdouble $\ast$src, gint sstr, gboolean eval\+\_\+neighbours, guint field, gdouble $\ast$work)
\begin{DoxyCompactList}\small\item\em Evaluate local field from regular expansion in box. \end{DoxyCompactList}\item 
guint64 \textbf{ wbfmm\+\_\+point\+\_\+index\+\_\+3d} (gdouble $\ast$x, gdouble $\ast$c, gdouble D)
\begin{DoxyCompactList}\small\item\em Find Morton index for point in a cubic domain. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+tree\+\_\+coefficient\+\_\+init} (\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$t, guint l, guint nr, guint ns)
\begin{DoxyCompactList}\small\item\em Initialize expansion coefficient data in an octree. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+tree\+\_\+refine} (\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$t)
\begin{DoxyCompactList}\small\item\em Refine an existing octree by adding a level and redistributing points attached to the tree to the boxes at the new level. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+tree\+\_\+laplace\+\_\+box\+\_\+local\+\_\+field} (\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$t, guint level, guint b, gdouble $\ast$x, gdouble $\ast$f, gdouble $\ast$src, gint sstr, gdouble $\ast$normals, gint nstr, gdouble $\ast$d, gint dstr, gboolean eval\+\_\+neighbours, gdouble $\ast$work)
\begin{DoxyCompactList}\small\item\em Evaluate local Laplace field from regular expansion in box. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+tree\+\_\+laplace\+\_\+leaf\+\_\+expansions} (\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$t, gdouble $\ast$src, gint sstr, gdouble $\ast$normals, gint nstr, gdouble $\ast$dipoles, gint dstr, gboolean zero\+\_\+expansions, gdouble $\ast$work)
\begin{DoxyCompactList}\small\item\em Generate leaf expansions for a tree in the Laplace problem. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+tree\+\_\+add\+\_\+points\+\_\+f} (\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$t, gpointer pts, gsize pstr, gpointer normals, gsize nstr, guint npts, gboolean sorted)
\begin{DoxyCompactList}\small\item\em Add points to an octree. \end{DoxyCompactList}\item 
\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$ \textbf{ wbfmm\+\_\+tree\+\_\+new\+\_\+f} (gfloat $\ast$x, gfloat D, guint maxpoints)
\begin{DoxyCompactList}\small\item\em Allocate a new octree. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+tree\+\_\+leaf\+\_\+expansions\+\_\+f} (\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$t, gfloat k, gfloat $\ast$src, gint sstr, gfloat $\ast$normals, gint nstr, gfloat $\ast$dipoles, gint dstr, gboolean zero\+\_\+expansions, gfloat $\ast$work)
\begin{DoxyCompactList}\small\item\em Generate leaf expansions for a tree. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+tree\+\_\+box\+\_\+field\+\_\+f} (\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$t, guint level, guint b, gfloat k, gfloat $\ast$x, gfloat $\ast$f, gint fstr, gfloat $\ast$work)
\begin{DoxyCompactList}\small\item\em Evaluate singular expansion about a box centre. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+tree\+\_\+box\+\_\+local\+\_\+field\+\_\+f} (\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$t, guint level, guint b, gfloat k, gfloat $\ast$x, gfloat $\ast$f, gint fstr, gfloat $\ast$src, gint sstr, gboolean eval\+\_\+neighbours, guint field, gfloat $\ast$work)
\begin{DoxyCompactList}\small\item\em Evaluate local field from regular expansion in box. \end{DoxyCompactList}\item 
guint64 \textbf{ wbfmm\+\_\+point\+\_\+index\+\_\+3d\+\_\+f} (gfloat $\ast$x, gfloat $\ast$c, gfloat D)
\begin{DoxyCompactList}\small\item\em Find Morton index for point in a cubic domain. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+tree\+\_\+coefficient\+\_\+init\+\_\+f} (\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$t, guint l, guint nr, guint ns)
\begin{DoxyCompactList}\small\item\em Initialize expansion coefficient data in an octree. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+tree\+\_\+refine\+\_\+f} (\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$t)
\begin{DoxyCompactList}\small\item\em Refine an existing octree by adding a level and redistributing points attached to the tree to the boxes at the new level. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+tree\+\_\+laplace\+\_\+box\+\_\+local\+\_\+field\+\_\+f} (\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$t, guint level, guint b, gfloat $\ast$x, gfloat $\ast$f, gfloat $\ast$src, gint sstr, gfloat $\ast$normals, gint nstr, gfloat $\ast$d, gint dstr, gboolean eval\+\_\+neighbours, gfloat $\ast$work)
\begin{DoxyCompactList}\small\item\em Evaluate local Laplace field from regular expansion in box. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+tree\+\_\+laplace\+\_\+leaf\+\_\+expansions\+\_\+f} (\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$t, gfloat $\ast$src, gint sstr, gfloat $\ast$normals, gint nstr, gfloat $\ast$dipoles, gint dstr, gboolean zero\+\_\+expansions, gfloat $\ast$work)
\begin{DoxyCompactList}\small\item\em Generate leaf expansions for a tree in the Laplace problem. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+tree\+\_\+add\+\_\+level} (\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$t)
\item 
gint \textbf{ wbfmm\+\_\+tree\+\_\+coefficients\+\_\+zero} (\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$t, guint level)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Operations on octree boxes and trees. 



\doxysubsection{Enumeration Type Documentation}
\mbox{\label{group__boxes_ga72eefe6d21d0860d8c79c60291006a4e}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_field\_t@{wbfmm\_field\_t}}
\index{wbfmm\_field\_t@{wbfmm\_field\_t}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_field\_t}
{\footnotesize\ttfamily enum \textbf{ wbfmm\+\_\+field\+\_\+t}}

Selection of field to be calculated \begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{WBFMM\_FIELD\_SCALAR@{WBFMM\_FIELD\_SCALAR}!Boxes and octrees@{Boxes and octrees}}\index{Boxes and octrees@{Boxes and octrees}!WBFMM\_FIELD\_SCALAR@{WBFMM\_FIELD\_SCALAR}}}\mbox{\label{group__boxes_gga72eefe6d21d0860d8c79c60291006a4ea35ece9ea76c38c84590c74b82691b0c4}} 
WBFMM\+\_\+\+FIELD\+\_\+\+SCALAR&scalar field \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{WBFMM\_FIELD\_GRADIENT@{WBFMM\_FIELD\_GRADIENT}!Boxes and octrees@{Boxes and octrees}}\index{Boxes and octrees@{Boxes and octrees}!WBFMM\_FIELD\_GRADIENT@{WBFMM\_FIELD\_GRADIENT}}}\mbox{\label{group__boxes_gga72eefe6d21d0860d8c79c60291006a4eaf7f9549d5b359762102d10c0abf13043}} 
WBFMM\+\_\+\+FIELD\+\_\+\+GRADIENT&gradient of scalar field \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{WBFMM\_FIELD\_CURL@{WBFMM\_FIELD\_CURL}!Boxes and octrees@{Boxes and octrees}}\index{Boxes and octrees@{Boxes and octrees}!WBFMM\_FIELD\_CURL@{WBFMM\_FIELD\_CURL}}}\mbox{\label{group__boxes_gga72eefe6d21d0860d8c79c60291006a4ea5b8f094ac70d692be60ad4dbf1dcd3a5}} 
WBFMM\+\_\+\+FIELD\+\_\+\+CURL&curl of vector field \\
\hline

\end{DoxyEnumFields}
\mbox{\label{group__boxes_ga543f6fd5c05c2399bf0a3625c0430552}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_problem\_t@{wbfmm\_problem\_t}}
\index{wbfmm\_problem\_t@{wbfmm\_problem\_t}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_problem\_t}
{\footnotesize\ttfamily enum \textbf{ wbfmm\+\_\+problem\+\_\+t}}

Selection of physical problem to be handled by a \doxyref{wbfmm\+\_\+tree\+\_\+t}{p.}{structwbfmm__tree__t} \begin{DoxyEnumFields}{Enumerator}
\raisebox{\heightof{T}}[0pt][0pt]{\index{WBFMM\_PROBLEM\_LAPLACE@{WBFMM\_PROBLEM\_LAPLACE}!Boxes and octrees@{Boxes and octrees}}\index{Boxes and octrees@{Boxes and octrees}!WBFMM\_PROBLEM\_LAPLACE@{WBFMM\_PROBLEM\_LAPLACE}}}\mbox{\label{group__boxes_gga543f6fd5c05c2399bf0a3625c0430552a5ae4679f802113e35ffc92b538d2b4ae}} 
WBFMM\+\_\+\+PROBLEM\+\_\+\+LAPLACE&Laplace equation \\
\hline

\raisebox{\heightof{T}}[0pt][0pt]{\index{WBFMM\_PROBLEM\_HELMHOLTZ@{WBFMM\_PROBLEM\_HELMHOLTZ}!Boxes and octrees@{Boxes and octrees}}\index{Boxes and octrees@{Boxes and octrees}!WBFMM\_PROBLEM\_HELMHOLTZ@{WBFMM\_PROBLEM\_HELMHOLTZ}}}\mbox{\label{group__boxes_gga543f6fd5c05c2399bf0a3625c0430552a41a0eaa8074cb51d13117e09e2bbc859}} 
WBFMM\+\_\+\+PROBLEM\+\_\+\+HELMHOLTZ&Helmholtz equation \\
\hline

\end{DoxyEnumFields}


\doxysubsection{Function Documentation}
\mbox{\label{group__boxes_gaf4fe54ab8180ef3460bc9283a6a5ef87}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_point\_index\_3d@{wbfmm\_point\_index\_3d}}
\index{wbfmm\_point\_index\_3d@{wbfmm\_point\_index\_3d}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_point\_index\_3d()}
{\footnotesize\ttfamily guint64 wbfmm\+\_\+point\+\_\+index\+\_\+3d (\begin{DoxyParamCaption}\item[{gdouble $\ast$}]{x,  }\item[{gdouble $\ast$}]{c,  }\item[{gdouble}]{D }\end{DoxyParamCaption})}



Find Morton index for point in a cubic domain. 


\begin{DoxyParams}{Parameters}
{\em x} & point in space (three components, densely packed); \\
\hline
{\em c} & location of bottom left corner of domain; \\
\hline
{\em D} & width of domain.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__boxes_gaed9d494a72a7a808860cd38da5f3c47b}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_point\_index\_3d\_f@{wbfmm\_point\_index\_3d\_f}}
\index{wbfmm\_point\_index\_3d\_f@{wbfmm\_point\_index\_3d\_f}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_point\_index\_3d\_f()}
{\footnotesize\ttfamily guint64 wbfmm\+\_\+point\+\_\+index\+\_\+3d\+\_\+f (\begin{DoxyParamCaption}\item[{gfloat $\ast$}]{x,  }\item[{gfloat $\ast$}]{c,  }\item[{gfloat}]{D }\end{DoxyParamCaption})}



Find Morton index for point in a cubic domain. 


\begin{DoxyParams}{Parameters}
{\em x} & point in space (three components, densely packed); \\
\hline
{\em c} & location of bottom left corner of domain; \\
\hline
{\em D} & width of domain.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__boxes_gadd47ecc4ffa77feb9313661010541c3e}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_tree\_add\_level@{wbfmm\_tree\_add\_level}}
\index{wbfmm\_tree\_add\_level@{wbfmm\_tree\_add\_level}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_tree\_add\_level()}
{\footnotesize\ttfamily gint wbfmm\+\_\+tree\+\_\+add\+\_\+level (\begin{DoxyParamCaption}\item[{\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t }\end{DoxyParamCaption})}

Add a new level to an existing octree. The function assigns memory for, and initializes, a new layer of boxes of type \doxyref{wbfmm\+\_\+box\+\_\+t}{p.}{structwbfmm__box__t}


\begin{DoxyParams}{Parameters}
{\em t} & an existing \doxyref{wbfmm\+\_\+tree\+\_\+t}{p.}{structwbfmm__tree__t}\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success. 
\end{DoxyReturn}


References \textbf{ wbfmm\+\_\+tree\+\_\+t\+::depth}.

\mbox{\label{group__boxes_gab9414343311c239db8c4161e42d0d978}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_tree\_add\_points@{wbfmm\_tree\_add\_points}}
\index{wbfmm\_tree\_add\_points@{wbfmm\_tree\_add\_points}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_tree\_add\_points()}
{\footnotesize\ttfamily gint wbfmm\+\_\+tree\+\_\+add\+\_\+points (\begin{DoxyParamCaption}\item[{\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t,  }\item[{gpointer}]{pts,  }\item[{gsize}]{pstr,  }\item[{gpointer}]{normals,  }\item[{gsize}]{nstr,  }\item[{guint}]{npts,  }\item[{gboolean}]{sorted }\end{DoxyParamCaption})}



Add points to an octree. 

Add a set of source points to an octree. The points are assumed to be in an array of real values with components in a packed triple, indexed using a stride of pstr bytes (this allows for quite general handling of different source formats).


\begin{DoxyParams}{Parameters}
{\em t} & an existing \doxyref{wbfmm\+\_\+tree\+\_\+t}{p.}{structwbfmm__tree__t}; \\
\hline
{\em pts} & an array containing point coordinates; \\
\hline
{\em pstr} & stride between points in bytes; \\
\hline
{\em normals} & normals at source points (can be NULL); \\
\hline
{\em nstr} & stride between normals in bytes; \\
\hline
{\em npts} & the number of points in {\itshape pts}; \\
\hline
{\em sorted} & if TRUE, the source points are assumed to be sorted in Morton index order and any source data used in subsequent calculations likewise.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success. 
\end{DoxyReturn}
\mbox{\label{group__boxes_ga036ea69500347586993a322a03880eff}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_tree\_add\_points\_f@{wbfmm\_tree\_add\_points\_f}}
\index{wbfmm\_tree\_add\_points\_f@{wbfmm\_tree\_add\_points\_f}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_tree\_add\_points\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+tree\+\_\+add\+\_\+points\+\_\+f (\begin{DoxyParamCaption}\item[{\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t,  }\item[{gpointer}]{pts,  }\item[{gsize}]{pstr,  }\item[{gpointer}]{normals,  }\item[{gsize}]{nstr,  }\item[{guint}]{npts,  }\item[{gboolean}]{sorted }\end{DoxyParamCaption})}



Add points to an octree. 

Add a set of source points to an octree. The points are assumed to be in an array of real values with components in a packed triple, indexed using a stride of pstr bytes (this allows for quite general handling of different source formats).


\begin{DoxyParams}{Parameters}
{\em t} & an existing \doxyref{wbfmm\+\_\+tree\+\_\+t}{p.}{structwbfmm__tree__t}; \\
\hline
{\em pts} & an array containing point coordinates; \\
\hline
{\em pstr} & stride between points in bytes; \\
\hline
{\em normals} & normals at source points (can be NULL); \\
\hline
{\em nstr} & stride between normals in bytes; \\
\hline
{\em npts} & the number of points in {\itshape pts}; \\
\hline
{\em sorted} & if TRUE, the source points are assumed to be sorted in Morton index order and any source data used in subsequent calculations likewise.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success. 
\end{DoxyReturn}
\mbox{\label{group__boxes_ga252f8fa31681dbdf2b0cc25779d9321b}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_tree\_box\_field@{wbfmm\_tree\_box\_field}}
\index{wbfmm\_tree\_box\_field@{wbfmm\_tree\_box\_field}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_tree\_box\_field()}
{\footnotesize\ttfamily gint wbfmm\+\_\+tree\+\_\+box\+\_\+field (\begin{DoxyParamCaption}\item[{\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t,  }\item[{guint}]{level,  }\item[{guint}]{b,  }\item[{gdouble}]{k,  }\item[{gdouble $\ast$}]{x,  }\item[{gdouble $\ast$}]{f,  }\item[{gint}]{fstr,  }\item[{gdouble $\ast$}]{work }\end{DoxyParamCaption})}



Evaluate singular expansion about a box centre. 


\begin{DoxyParams}{Parameters}
{\em t} & octree for problem; \\
\hline
{\em level} & level in {\itshape t}; \\
\hline
{\em b} & index of box at level {\itshape level} of {\itshape t}; \\
\hline
{\em k} & wavenumber; \\
\hline
{\em x} & field evaluation point; \\
\hline
{\em f} & on output field at {\itshape x} (not zeroed before evaluation); \\
\hline
{\em fstr} & stride in {\itshape field} in number of array entries; \\
\hline
{\em work} & workspace\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__boxes_gaeabd371c311cc5378faaa8ad2cee864c}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_tree\_box\_field\_f@{wbfmm\_tree\_box\_field\_f}}
\index{wbfmm\_tree\_box\_field\_f@{wbfmm\_tree\_box\_field\_f}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_tree\_box\_field\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+tree\+\_\+box\+\_\+field\+\_\+f (\begin{DoxyParamCaption}\item[{\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t,  }\item[{guint}]{level,  }\item[{guint}]{b,  }\item[{gfloat}]{k,  }\item[{gfloat $\ast$}]{x,  }\item[{gfloat $\ast$}]{f,  }\item[{gint}]{fstr,  }\item[{gfloat $\ast$}]{work }\end{DoxyParamCaption})}



Evaluate singular expansion about a box centre. 


\begin{DoxyParams}{Parameters}
{\em t} & octree for problem; \\
\hline
{\em level} & level in {\itshape t}; \\
\hline
{\em b} & index of box at level {\itshape level} of {\itshape t}; \\
\hline
{\em k} & wavenumber; \\
\hline
{\em x} & field evaluation point; \\
\hline
{\em f} & on output field at {\itshape x} (not zeroed before evaluation); \\
\hline
{\em fstr} & stride in {\itshape field} in number of array entries; \\
\hline
{\em work} & workspace\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__boxes_ga30fed6f06740bcad070aadaf1f499865}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_tree\_box\_local\_field@{wbfmm\_tree\_box\_local\_field}}
\index{wbfmm\_tree\_box\_local\_field@{wbfmm\_tree\_box\_local\_field}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_tree\_box\_local\_field()}
{\footnotesize\ttfamily gint wbfmm\+\_\+tree\+\_\+box\+\_\+local\+\_\+field (\begin{DoxyParamCaption}\item[{\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t,  }\item[{guint}]{level,  }\item[{guint}]{b,  }\item[{gdouble}]{k,  }\item[{gdouble $\ast$}]{x,  }\item[{gdouble $\ast$}]{f,  }\item[{gint}]{fstr,  }\item[{gdouble $\ast$}]{src,  }\item[{gint}]{sstr,  }\item[{gboolean}]{eval\+\_\+neighbours,  }\item[{guint}]{field,  }\item[{gdouble $\ast$}]{work }\end{DoxyParamCaption})}



Evaluate local field from regular expansion in box. 


\begin{DoxyParams}{Parameters}
{\em t} & octree for domain; \\
\hline
{\em level} & level of {\itshape t}; \\
\hline
{\em b} & box index at level {\itshape level} of {\itshape t}; \\
\hline
{\em k} & wavenumber; \\
\hline
{\em x} & location of evaluation point; \\
\hline
{\em f} & on output, field value (not zeroed before evaluation); \\
\hline
{\em fstr} & stride of data in {\itshape f}; \\
\hline
{\em src} & source strengths; \\
\hline
{\em sstr} & stride of data in {\itshape src}; \\
\hline
{\em eval\+\_\+neighbours} & if TRUE compute contributions from sources in box {\itshape b} and neighbours; \\
\hline
{\em field} & XOR combination of \doxyref{wbfmm\+\_\+field\+\_\+t}{p.}{group__boxes_ga72eefe6d21d0860d8c79c60291006a4e} to select output field type (scalar, gradient, curl, etc.); \\
\hline
{\em work} & workspace.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__boxes_gaea123d47e282266840fa39af0866f433}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_tree\_box\_local\_field\_f@{wbfmm\_tree\_box\_local\_field\_f}}
\index{wbfmm\_tree\_box\_local\_field\_f@{wbfmm\_tree\_box\_local\_field\_f}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_tree\_box\_local\_field\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+tree\+\_\+box\+\_\+local\+\_\+field\+\_\+f (\begin{DoxyParamCaption}\item[{\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t,  }\item[{guint}]{level,  }\item[{guint}]{b,  }\item[{gfloat}]{k,  }\item[{gfloat $\ast$}]{x,  }\item[{gfloat $\ast$}]{f,  }\item[{gint}]{fstr,  }\item[{gfloat $\ast$}]{src,  }\item[{gint}]{sstr,  }\item[{gboolean}]{eval\+\_\+neighbours,  }\item[{guint}]{field,  }\item[{gfloat $\ast$}]{work }\end{DoxyParamCaption})}



Evaluate local field from regular expansion in box. 


\begin{DoxyParams}{Parameters}
{\em t} & octree for domain; \\
\hline
{\em level} & level of {\itshape t}; \\
\hline
{\em b} & box index at level {\itshape level} of {\itshape t}; \\
\hline
{\em k} & wavenumber; \\
\hline
{\em x} & location of evaluation point; \\
\hline
{\em f} & on output, field value (not zeroed before evaluation); \\
\hline
{\em fstr} & stride of data in {\itshape f}; \\
\hline
{\em src} & source strengths; \\
\hline
{\em sstr} & stride of data in {\itshape src}; \\
\hline
{\em eval\+\_\+neighbours} & if TRUE compute contributions from sources in box {\itshape b} and neighbours; \\
\hline
{\em field} & XOR combination of \doxyref{wbfmm\+\_\+field\+\_\+t}{p.}{group__boxes_ga72eefe6d21d0860d8c79c60291006a4e} to select output field type (scalar, gradient, curl, etc.); \\
\hline
{\em work} & workspace.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__boxes_ga091c6f775fa64cd58db004fbb18995c8}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_tree\_coefficient\_init@{wbfmm\_tree\_coefficient\_init}}
\index{wbfmm\_tree\_coefficient\_init@{wbfmm\_tree\_coefficient\_init}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_tree\_coefficient\_init()}
{\footnotesize\ttfamily gint wbfmm\+\_\+tree\+\_\+coefficient\+\_\+init (\begin{DoxyParamCaption}\item[{\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t,  }\item[{guint}]{l,  }\item[{guint}]{nr,  }\item[{guint}]{ns }\end{DoxyParamCaption})}



Initialize expansion coefficient data in an octree. 


\begin{DoxyParams}{Parameters}
{\em t} & octree for problem; \\
\hline
{\em l} & level to initialize data for; \\
\hline
{\em nr} & order of regular expansions at level {\itshape l}; \\
\hline
{\em ns} & order of singular expansions at level {\itshape l}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__boxes_ga4332e5e154107afd81e9810465975460}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_tree\_coefficient\_init\_f@{wbfmm\_tree\_coefficient\_init\_f}}
\index{wbfmm\_tree\_coefficient\_init\_f@{wbfmm\_tree\_coefficient\_init\_f}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_tree\_coefficient\_init\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+tree\+\_\+coefficient\+\_\+init\+\_\+f (\begin{DoxyParamCaption}\item[{\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t,  }\item[{guint}]{l,  }\item[{guint}]{nr,  }\item[{guint}]{ns }\end{DoxyParamCaption})}



Initialize expansion coefficient data in an octree. 


\begin{DoxyParams}{Parameters}
{\em t} & octree for problem; \\
\hline
{\em l} & level to initialize data for; \\
\hline
{\em nr} & order of regular expansions at level {\itshape l}; \\
\hline
{\em ns} & order of singular expansions at level {\itshape l}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__boxes_ga706d8fc70c084ec74f2d26c650dd593b}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_tree\_coefficients\_zero@{wbfmm\_tree\_coefficients\_zero}}
\index{wbfmm\_tree\_coefficients\_zero@{wbfmm\_tree\_coefficients\_zero}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_tree\_coefficients\_zero()}
{\footnotesize\ttfamily gint wbfmm\+\_\+tree\+\_\+coefficients\+\_\+zero (\begin{DoxyParamCaption}\item[{\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t,  }\item[{guint}]{level }\end{DoxyParamCaption})}

Set the regular expansion coefficients at a level to zero, for when a tree is being reused.


\begin{DoxyParams}{Parameters}
{\em t} & a \doxyref{wbfmm\+\_\+tree\+\_\+t}{p.}{structwbfmm__tree__t} \\
\hline
{\em level} & a level of {\itshape t} \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success. 
\end{DoxyReturn}


References \textbf{ wbfmm\+\_\+tree\+\_\+t\+::order\+\_\+r}.

\mbox{\label{group__boxes_ga86787ea2121b4d3fea7b8c258c75c8ae}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_tree\_laplace\_box\_local\_field@{wbfmm\_tree\_laplace\_box\_local\_field}}
\index{wbfmm\_tree\_laplace\_box\_local\_field@{wbfmm\_tree\_laplace\_box\_local\_field}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_tree\_laplace\_box\_local\_field()}
{\footnotesize\ttfamily gint wbfmm\+\_\+tree\+\_\+laplace\+\_\+box\+\_\+local\+\_\+field (\begin{DoxyParamCaption}\item[{\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t,  }\item[{guint}]{level,  }\item[{guint}]{b,  }\item[{gdouble $\ast$}]{x,  }\item[{gdouble $\ast$}]{f,  }\item[{gdouble $\ast$}]{src,  }\item[{gint}]{sstr,  }\item[{gdouble $\ast$}]{normals,  }\item[{gint}]{nstr,  }\item[{gdouble $\ast$}]{d,  }\item[{gint}]{dstr,  }\item[{gboolean}]{eval\+\_\+neighbours,  }\item[{gdouble $\ast$}]{work }\end{DoxyParamCaption})}



Evaluate local Laplace field from regular expansion in box. 


\begin{DoxyParams}{Parameters}
{\em t} & octree for domain; \\
\hline
{\em level} & level of {\itshape t}; \\
\hline
{\em b} & box index at level {\itshape level} of {\itshape t}; \\
\hline
{\em x} & location of evaluation point; \\
\hline
{\em f} & on output, field value (not zeroed before evaluation); \\
\hline
{\em src} & source strengths; \\
\hline
{\em sstr} & stride of data in {\itshape src}; \\
\hline
{\em normals} & normals for dipole sources; \\
\hline
{\em nstr} & stride in {\itshape normals}; \\
\hline
{\em d} & dipole source strengths, or dipole vectors; \\
\hline
{\em dstr} & stride in {\itshape d}; \\
\hline
{\em eval\+\_\+neighbours} & if TRUE compute contributions from sources in box {\itshape b} and neighbours; \\
\hline
{\em work} & workspace.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__boxes_gabfdf2b25b90f3701088aa9b3ba21cf78}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_tree\_laplace\_box\_local\_field\_f@{wbfmm\_tree\_laplace\_box\_local\_field\_f}}
\index{wbfmm\_tree\_laplace\_box\_local\_field\_f@{wbfmm\_tree\_laplace\_box\_local\_field\_f}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_tree\_laplace\_box\_local\_field\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+tree\+\_\+laplace\+\_\+box\+\_\+local\+\_\+field\+\_\+f (\begin{DoxyParamCaption}\item[{\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t,  }\item[{guint}]{level,  }\item[{guint}]{b,  }\item[{gfloat $\ast$}]{x,  }\item[{gfloat $\ast$}]{f,  }\item[{gfloat $\ast$}]{src,  }\item[{gint}]{sstr,  }\item[{gfloat $\ast$}]{normals,  }\item[{gint}]{nstr,  }\item[{gfloat $\ast$}]{d,  }\item[{gint}]{dstr,  }\item[{gboolean}]{eval\+\_\+neighbours,  }\item[{gfloat $\ast$}]{work }\end{DoxyParamCaption})}



Evaluate local Laplace field from regular expansion in box. 


\begin{DoxyParams}{Parameters}
{\em t} & octree for domain; \\
\hline
{\em level} & level of {\itshape t}; \\
\hline
{\em b} & box index at level {\itshape level} of {\itshape t}; \\
\hline
{\em x} & location of evaluation point; \\
\hline
{\em f} & on output, field value (not zeroed before evaluation); \\
\hline
{\em src} & source strengths; \\
\hline
{\em sstr} & stride of data in {\itshape src}; \\
\hline
{\em normals} & normals for dipole sources; \\
\hline
{\em nstr} & stride in {\itshape normals}; \\
\hline
{\em d} & dipole source strengths, or dipole vectors; \\
\hline
{\em dstr} & stride in {\itshape d}; \\
\hline
{\em eval\+\_\+neighbours} & if TRUE compute contributions from sources in box {\itshape b} and neighbours; \\
\hline
{\em work} & workspace.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__boxes_ga00f1078aec5a2ff428878cb83e1cf48e}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_tree\_laplace\_leaf\_expansions@{wbfmm\_tree\_laplace\_leaf\_expansions}}
\index{wbfmm\_tree\_laplace\_leaf\_expansions@{wbfmm\_tree\_laplace\_leaf\_expansions}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_tree\_laplace\_leaf\_expansions()}
{\footnotesize\ttfamily gint wbfmm\+\_\+tree\+\_\+laplace\+\_\+leaf\+\_\+expansions (\begin{DoxyParamCaption}\item[{\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t,  }\item[{gdouble $\ast$}]{src,  }\item[{gint}]{sstr,  }\item[{gdouble $\ast$}]{normals,  }\item[{gint}]{nstr,  }\item[{gdouble $\ast$}]{dipoles,  }\item[{gint}]{dstr,  }\item[{gboolean}]{zero\+\_\+expansions,  }\item[{gdouble $\ast$}]{work }\end{DoxyParamCaption})}



Generate leaf expansions for a tree in the Laplace problem. 

Generate leaf expansions for a tree for the Laplace problem given some combination of monopole and dipole sources. Source positions are those in the point list attached to the tree using \doxyref{wbfmm\+\_\+tree\+\_\+add\+\_\+points}{p.}{group__boxes_gab9414343311c239db8c4161e42d0d978} and indexing in the array must correspond to that in the point list. Input arrays may be NULL\+: if {\itshape src} is not NULL, it is interpreted as a list of monopole strengths; if {\itshape normals} is not NULL, {\itshape dipoles} may not be NULL and they are interpreted respectively as a vector (`normal') at each source position and a scalar amplitude (this corresponds to surface normal and a normal velocity amplitude in a boundary element method calculation); if {\itshape normals} is NULL and {\itshape dipoles} is not NULL, {\itshape dipoles} is interpreted as a three-\/element vector specifying the dipole strength. The strides {\itshape sstr}, {\itshape nstr}, and {\itshape dstr} are the number of scalar elements between successive entries in the arrays, with the elements of each entry densely packed. For example, a list of normals might read\+:

$[n_{x1}\quad n_{y1}\quad n_{z1}\quad a_{1}\quad b_{1}\quad n_{x2} \ldots]$

where $(n_{x1},n_{y1},n_{z1})$ is the first normal vector and $a_{1}$ and $b_{1}$ are arbitrary entries in the array. In this case, the stride {\itshape nstr} would be 5, the number of elements between successive values of $n_{xi}$.


\begin{DoxyParams}{Parameters}
{\em t} & octree for problem; \\
\hline
{\em src} & monopole source strengths; \\
\hline
{\em sstr} & stride of data in {\itshape src}; \\
\hline
{\em normals} & dipole normals; \\
\hline
{\em nstr} & stride of data in {\itshape normals}; \\
\hline
{\em dipoles} & dipole source strengths (if {\itshape normals} is not NULL), or moment vectors (if {\itshape normals} is NULL); \\
\hline
{\em dstr} & stride of data in {\itshape dipoles}; \\
\hline
{\em zero\+\_\+expansions} & if TRUE, set expansion coefficients to zero before adding source terms; \\
\hline
{\em work} & workspace.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__boxes_ga5c5fdc5398d73ef19d9c55a7ce150f91}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_tree\_laplace\_leaf\_expansions\_f@{wbfmm\_tree\_laplace\_leaf\_expansions\_f}}
\index{wbfmm\_tree\_laplace\_leaf\_expansions\_f@{wbfmm\_tree\_laplace\_leaf\_expansions\_f}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_tree\_laplace\_leaf\_expansions\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+tree\+\_\+laplace\+\_\+leaf\+\_\+expansions\+\_\+f (\begin{DoxyParamCaption}\item[{\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t,  }\item[{gfloat $\ast$}]{src,  }\item[{gint}]{sstr,  }\item[{gfloat $\ast$}]{normals,  }\item[{gint}]{nstr,  }\item[{gfloat $\ast$}]{dipoles,  }\item[{gint}]{dstr,  }\item[{gboolean}]{zero\+\_\+expansions,  }\item[{gfloat $\ast$}]{work }\end{DoxyParamCaption})}



Generate leaf expansions for a tree in the Laplace problem. 

Generate leaf expansions for a tree for the Laplace problem given some combination of monopole and dipole sources. Source positions are those in the point list attached to the tree using \doxyref{wbfmm\+\_\+tree\+\_\+add\+\_\+points}{p.}{group__boxes_gab9414343311c239db8c4161e42d0d978} and indexing in the array must correspond to that in the point list. Input arrays may be NULL\+: if {\itshape src} is not NULL, it is interpreted as a list of monopole strengths; if {\itshape normals} is not NULL, {\itshape dipoles} may not be NULL and they are interpreted respectively as a vector (`normal') at each source position and a scalar amplitude (this corresponds to surface normal and a normal velocity amplitude in a boundary element method calculation); if {\itshape normals} is NULL and {\itshape dipoles} is not NULL, {\itshape dipoles} is interpreted as a three-\/element vector specifying the dipole strength. The strides {\itshape sstr}, {\itshape nstr}, and {\itshape dstr} are the number of scalar elements between successive entries in the arrays, with the elements of each entry densely packed. For example, a list of normals might read\+:

$[n_{x1}\quad n_{y1}\quad n_{z1}\quad a_{1}\quad b_{1}\quad n_{x2} \ldots]$

where $(n_{x1},n_{y1},n_{z1})$ is the first normal vector and $a_{1}$ and $b_{1}$ are arbitrary entries in the array. In this case, the stride {\itshape nstr} would be 5, the number of elements between successive values of $n_{xi}$.


\begin{DoxyParams}{Parameters}
{\em t} & octree for problem; \\
\hline
{\em src} & monopole source strengths; \\
\hline
{\em sstr} & stride of data in {\itshape src}; \\
\hline
{\em normals} & dipole normals; \\
\hline
{\em nstr} & stride of data in {\itshape normals}; \\
\hline
{\em dipoles} & dipole source strengths (if {\itshape normals} is not NULL), or moment vectors (if {\itshape normals} is NULL); \\
\hline
{\em dstr} & stride of data in {\itshape dipoles}; \\
\hline
{\em zero\+\_\+expansions} & if TRUE, set expansion coefficients to zero before adding source terms; \\
\hline
{\em work} & workspace.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__boxes_gacff456ef3d99c08c93be852ec781aa2a}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_tree\_leaf\_expansions@{wbfmm\_tree\_leaf\_expansions}}
\index{wbfmm\_tree\_leaf\_expansions@{wbfmm\_tree\_leaf\_expansions}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_tree\_leaf\_expansions()}
{\footnotesize\ttfamily gint wbfmm\+\_\+tree\+\_\+leaf\+\_\+expansions (\begin{DoxyParamCaption}\item[{\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t,  }\item[{gdouble}]{k,  }\item[{gdouble $\ast$}]{src,  }\item[{gint}]{sstr,  }\item[{gdouble $\ast$}]{normals,  }\item[{gint}]{nstr,  }\item[{gdouble $\ast$}]{dipoles,  }\item[{gint}]{dstr,  }\item[{gboolean}]{zero\+\_\+expansions,  }\item[{gdouble $\ast$}]{work }\end{DoxyParamCaption})}



Generate leaf expansions for a tree. 

Generate leaf expansions for a tree given some combination of monopole and dipole sources. Source positions are those in the point list attached to the tree using \doxyref{wbfmm\+\_\+tree\+\_\+add\+\_\+points}{p.}{group__boxes_gab9414343311c239db8c4161e42d0d978} and indexing in the array must correspond to that in the point list. Input arrays may be NULL\+: if {\itshape src} is not NULL, it is interpreted as a list of complex monopole strengths; if {\itshape normals} is not NULL, {\itshape dipoles} may not be NULL and they are interpreted respectively as a vector (`normal') at each source position and a scalar complex amplitude (this corresponds to surface normal and a normal velocity amplitude in a boundary element method calculation); if {\itshape normals} is NULL and {\itshape dipoles} is not NULL, {\itshape dipoles} is interpreted as a three-\/element complex vector specifying the dipole strength. The strides {\itshape sstr}, {\itshape nstr}, and {\itshape dstr} are the number of scalar elements between successive entries in the arrays, with the elements of each entry densely packed. For example, a list of normals might read\+:

$[n_{x1}\quad n_{y1}\quad n_{z1}\quad a_{1}\quad b_{1}\quad n_{x2} \ldots]$

where $(n_{x1},n_{y1},n_{z1})$ is the first normal vector and $a_{1}$ and $b_{1}$ are arbitrary entries in the array. In this case, the stride {\itshape nstr} would be 5, the number of elements between successive values of $n_{xi}$.


\begin{DoxyParams}{Parameters}
{\em t} & octree for problem; \\
\hline
{\em k} & wavenumber; \\
\hline
{\em src} & monopole source strengths; \\
\hline
{\em sstr} & stride of data in {\itshape src}; \\
\hline
{\em normals} & dipole normals; \\
\hline
{\em nstr} & stride of data in {\itshape normals}; \\
\hline
{\em dipoles} & dipole source strengths (if {\itshape normals} is not NULL), or moment vectors (if {\itshape normals} is NULL); \\
\hline
{\em dstr} & stride of data in {\itshape dipoles}; \\
\hline
{\em zero\+\_\+expansions} & if TRUE, set expansion coefficients to zero before adding source terms; \\
\hline
{\em work} & workspace.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__boxes_ga0fe2ee1d112ae2f61ebf75f36f4e0698}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_tree\_leaf\_expansions\_f@{wbfmm\_tree\_leaf\_expansions\_f}}
\index{wbfmm\_tree\_leaf\_expansions\_f@{wbfmm\_tree\_leaf\_expansions\_f}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_tree\_leaf\_expansions\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+tree\+\_\+leaf\+\_\+expansions\+\_\+f (\begin{DoxyParamCaption}\item[{\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t,  }\item[{gfloat}]{k,  }\item[{gfloat $\ast$}]{src,  }\item[{gint}]{sstr,  }\item[{gfloat $\ast$}]{normals,  }\item[{gint}]{nstr,  }\item[{gfloat $\ast$}]{dipoles,  }\item[{gint}]{dstr,  }\item[{gboolean}]{zero\+\_\+expansions,  }\item[{gfloat $\ast$}]{work }\end{DoxyParamCaption})}



Generate leaf expansions for a tree. 

Generate leaf expansions for a tree given some combination of monopole and dipole sources. Source positions are those in the point list attached to the tree using \doxyref{wbfmm\+\_\+tree\+\_\+add\+\_\+points}{p.}{group__boxes_gab9414343311c239db8c4161e42d0d978} and indexing in the array must correspond to that in the point list. Input arrays may be NULL\+: if {\itshape src} is not NULL, it is interpreted as a list of complex monopole strengths; if {\itshape normals} is not NULL, {\itshape dipoles} may not be NULL and they are interpreted respectively as a vector (`normal') at each source position and a scalar complex amplitude (this corresponds to surface normal and a normal velocity amplitude in a boundary element method calculation); if {\itshape normals} is NULL and {\itshape dipoles} is not NULL, {\itshape dipoles} is interpreted as a three-\/element complex vector specifying the dipole strength. The strides {\itshape sstr}, {\itshape nstr}, and {\itshape dstr} are the number of scalar elements between successive entries in the arrays, with the elements of each entry densely packed. For example, a list of normals might read\+:

$[n_{x1}\quad n_{y1}\quad n_{z1}\quad a_{1}\quad b_{1}\quad n_{x2} \ldots]$

where $(n_{x1},n_{y1},n_{z1})$ is the first normal vector and $a_{1}$ and $b_{1}$ are arbitrary entries in the array. In this case, the stride {\itshape nstr} would be 5, the number of elements between successive values of $n_{xi}$.


\begin{DoxyParams}{Parameters}
{\em t} & octree for problem; \\
\hline
{\em k} & wavenumber; \\
\hline
{\em src} & monopole source strengths; \\
\hline
{\em sstr} & stride of data in {\itshape src}; \\
\hline
{\em normals} & dipole normals; \\
\hline
{\em nstr} & stride of data in {\itshape normals}; \\
\hline
{\em dipoles} & dipole source strengths (if {\itshape normals} is not NULL), or moment vectors (if {\itshape normals} is NULL); \\
\hline
{\em dstr} & stride of data in {\itshape dipoles}; \\
\hline
{\em zero\+\_\+expansions} & if TRUE, set expansion coefficients to zero before adding source terms; \\
\hline
{\em work} & workspace.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__boxes_ga2fa5e9e3c7b142bb2712144252f7a71c}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_tree\_new@{wbfmm\_tree\_new}}
\index{wbfmm\_tree\_new@{wbfmm\_tree\_new}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_tree\_new()}
{\footnotesize\ttfamily \textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$ wbfmm\+\_\+tree\+\_\+new (\begin{DoxyParamCaption}\item[{gdouble $\ast$}]{x,  }\item[{gdouble}]{D,  }\item[{guint}]{maxpoints }\end{DoxyParamCaption})}



Allocate a new octree. 


\begin{DoxyParams}{Parameters}
{\em x} & location of origin of tree; \\
\hline
{\em D} & width of domain; \\
\hline
{\em maxpoints} & maximum number of source points in tree.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
pointer to newly allocated tree. 
\end{DoxyReturn}
\mbox{\label{group__boxes_ga3903bb9b8e5c7054c8b3cff356b48eb9}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_tree\_new\_f@{wbfmm\_tree\_new\_f}}
\index{wbfmm\_tree\_new\_f@{wbfmm\_tree\_new\_f}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_tree\_new\_f()}
{\footnotesize\ttfamily \textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$ wbfmm\+\_\+tree\+\_\+new\+\_\+f (\begin{DoxyParamCaption}\item[{gfloat $\ast$}]{x,  }\item[{gfloat}]{D,  }\item[{guint}]{maxpoints }\end{DoxyParamCaption})}



Allocate a new octree. 


\begin{DoxyParams}{Parameters}
{\em x} & location of origin of tree; \\
\hline
{\em D} & width of domain; \\
\hline
{\em maxpoints} & maximum number of source points in tree.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
pointer to newly allocated tree. 
\end{DoxyReturn}
\mbox{\label{group__boxes_ga6662da7d3ec452d58201d0a6464286e4}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_tree\_refine@{wbfmm\_tree\_refine}}
\index{wbfmm\_tree\_refine@{wbfmm\_tree\_refine}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_tree\_refine()}
{\footnotesize\ttfamily gint wbfmm\+\_\+tree\+\_\+refine (\begin{DoxyParamCaption}\item[{\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t }\end{DoxyParamCaption})}



Refine an existing octree by adding a level and redistributing points attached to the tree to the boxes at the new level. 


\begin{DoxyParams}{Parameters}
{\em t} & an existing \doxyref{wbfmm\+\_\+tree\+\_\+t}{p.}{structwbfmm__tree__t}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success. 
\end{DoxyReturn}
\mbox{\label{group__boxes_gac6bccb17227a1d01d8aa1d38c09223c3}} 
\index{Boxes and octrees@{Boxes and octrees}!wbfmm\_tree\_refine\_f@{wbfmm\_tree\_refine\_f}}
\index{wbfmm\_tree\_refine\_f@{wbfmm\_tree\_refine\_f}!Boxes and octrees@{Boxes and octrees}}
\doxysubsubsection{wbfmm\_tree\_refine\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+tree\+\_\+refine\+\_\+f (\begin{DoxyParamCaption}\item[{\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t }\end{DoxyParamCaption})}



Refine an existing octree by adding a level and redistributing points attached to the tree to the boxes at the new level. 


\begin{DoxyParams}{Parameters}
{\em t} & an existing \doxyref{wbfmm\+\_\+tree\+\_\+t}{p.}{structwbfmm__tree__t}.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success. 
\end{DoxyReturn}
