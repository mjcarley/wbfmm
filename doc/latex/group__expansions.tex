\section{Generation and evaluation of expansions}
\label{group__expansions}\index{Generation and evaluation of expansions@{Generation and evaluation of expansions}}


Generation of regular and singular expansions and evaluation of them at field points.  


\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
gint {\bf wbfmm\+\_\+expansion\+\_\+h\+\_\+cfft} (gdouble k, gint N, gdouble $\ast$x0, gdouble $\ast$xs, gdouble $\ast$q, gint nq, gdouble $\ast$cfft, gint cstr, gdouble $\ast$work)
\begin{DoxyCompactList}\small\item\em Generation of singular expansion coefficients for point source. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+expansion\+\_\+dipole\+\_\+h\+\_\+cfft} (gdouble k, gint N, gdouble $\ast$x0, gdouble $\ast$xs, gdouble $\ast$fx, gdouble $\ast$fy, gdouble $\ast$fz, gint nq, gdouble $\ast$cfft, gint cstr, gdouble $\ast$work)
\begin{DoxyCompactList}\small\item\em Generation of singular expansion coefficients for point dipole source. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+expansion\+\_\+normal\+\_\+h\+\_\+cfft} (gdouble k, gint N, gdouble $\ast$x0, gdouble $\ast$xs, gdouble $\ast$normal, gdouble $\ast$q, gint nq, gdouble $\ast$cfft, gint cstr, gdouble $\ast$work)
\begin{DoxyCompactList}\small\item\em Generation of singular expansion coefficients for point dipole source defined as normal and strength. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+expansion\+\_\+h\+\_\+evaluate} (gdouble k, gdouble $\ast$x0, gdouble $\ast$cfft, gint cstr, gint N, gint nq, gdouble $\ast$xf, gdouble $\ast$field, gint fstr, gdouble $\ast$work)
\begin{DoxyCompactList}\small\item\em Evaluate a singular expansion. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+expansion\+\_\+h\+\_\+grad\+\_\+evaluate} (gdouble k, gdouble $\ast$x0, gdouble $\ast$cfft, gint cstr, gint N, gint nq, gdouble $\ast$xf, gdouble $\ast$field, gdouble $\ast$work)
\begin{DoxyCompactList}\small\item\em Evaluate the gradient of a singular expansion. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+expansion\+\_\+j\+\_\+grad\+\_\+evaluate} (gdouble k, gdouble $\ast$x0, gdouble $\ast$cfft, gint cstr, gint N, gint nq, gdouble $\ast$xf, gdouble $\ast$field, gint fstr, gdouble $\ast$work)
\begin{DoxyCompactList}\small\item\em Evaluate the gradient of a regular expansion. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+expansion\+\_\+j\+\_\+evaluate} (gdouble k, gdouble $\ast$x0, gdouble $\ast$cfft, gint cstr, gint nq, gint N, gdouble $\ast$xf, gdouble $\ast$field, gint fstr, gdouble $\ast$work)
\begin{DoxyCompactList}\small\item\em Evaluate a regular expansion. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+expansion\+\_\+h\+\_\+cfft\+\_\+f} (gfloat k, gint N, gfloat $\ast$x0, gfloat $\ast$xs, gfloat $\ast$q, gint nq, gfloat $\ast$cfft, gint cstr, gfloat $\ast$work)
\begin{DoxyCompactList}\small\item\em Generation of singular expansion coefficients for point source. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+expansion\+\_\+dipole\+\_\+h\+\_\+cfft\+\_\+f} (gfloat k, gint N, gfloat $\ast$x0, gfloat $\ast$xs, gfloat $\ast$fx, gfloat $\ast$fy, gfloat $\ast$fz, gint nq, gfloat $\ast$cfft, gint cstr, gfloat $\ast$work)
\begin{DoxyCompactList}\small\item\em Generation of singular expansion coefficients for point dipole source. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+expansion\+\_\+normal\+\_\+h\+\_\+cfft\+\_\+f} (gfloat k, gint N, gfloat $\ast$x0, gfloat $\ast$xs, gfloat $\ast$normal, gfloat $\ast$q, gint nq, gfloat $\ast$cfft, gint cstr, gfloat $\ast$work)
\begin{DoxyCompactList}\small\item\em Generation of singular expansion coefficients for point dipole source defined as normal and strength. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+expansion\+\_\+h\+\_\+evaluate\+\_\+f} (gfloat k, gfloat $\ast$x0, gfloat $\ast$cfft, gint cstr, gint N, gint nq, gfloat $\ast$xf, gfloat $\ast$field, gint fstr, gfloat $\ast$work)
\begin{DoxyCompactList}\small\item\em Evaluate a singular expansion. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+expansion\+\_\+h\+\_\+grad\+\_\+evaluate\+\_\+f} (gfloat k, gfloat $\ast$x0, gfloat $\ast$cfft, gint cstr, gint N, gint nq, gfloat $\ast$xf, gfloat $\ast$field, gfloat $\ast$work)
\begin{DoxyCompactList}\small\item\em Evaluate the gradient of a singular expansion. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+expansion\+\_\+j\+\_\+grad\+\_\+evaluate\+\_\+f} (gfloat k, gfloat $\ast$x0, gfloat $\ast$cfft, gint cstr, gint N, gint nq, gfloat $\ast$xf, gfloat $\ast$field, gint fstr, gfloat $\ast$work)
\begin{DoxyCompactList}\small\item\em Evaluate the gradient of a regular expansion. \end{DoxyCompactList}\item 
gint {\bf wbfmm\+\_\+expansion\+\_\+j\+\_\+evaluate\+\_\+f} (gfloat k, gfloat $\ast$x0, gfloat $\ast$cfft, gint cstr, gint nq, gint N, gfloat $\ast$xf, gfloat $\ast$field, gint fstr, gfloat $\ast$work)
\begin{DoxyCompactList}\small\item\em Evaluate a regular expansion. \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Generation of regular and singular expansions and evaluation of them at field points. 

The functions described here handle spherical harmonic expansions of complex variables, solutions of the Helmholtz equations. Expansions of real variables are dealt with in a separate set of functions, for the Laplace equation (\doxyref{Evaluation of the Laplace potential}{p.}{group__laplace}). The expansion coefficients are packed in single-\/ or double-\/precision arrays with the index of coefficient $C_{n}^{m}$, $-n\leq m \leq n$ given by $i=n(n+1)+m$. Coefficients are represented as real and imaginary parts, so that the coefficient is given by array entries $C_{si+0}+jC_{si+1}$ where $i$ is the index, $s$ is a stride allowing interleaved packing of data, and $C_{n}$ is an array entry. 

\subsection{Function Documentation}
\index{Generation and evaluation of expansions@{Generation and evaluation of expansions}!wbfmm\+\_\+expansion\+\_\+dipole\+\_\+h\+\_\+cfft@{wbfmm\+\_\+expansion\+\_\+dipole\+\_\+h\+\_\+cfft}}
\index{wbfmm\+\_\+expansion\+\_\+dipole\+\_\+h\+\_\+cfft@{wbfmm\+\_\+expansion\+\_\+dipole\+\_\+h\+\_\+cfft}!Generation and evaluation of expansions@{Generation and evaluation of expansions}}
\subsubsection[{wbfmm\+\_\+expansion\+\_\+dipole\+\_\+h\+\_\+cfft}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+expansion\+\_\+dipole\+\_\+h\+\_\+cfft (
\begin{DoxyParamCaption}
\item[{gdouble}]{k, }
\item[{gint}]{N, }
\item[{gdouble $\ast$}]{x0, }
\item[{gdouble $\ast$}]{xs, }
\item[{gdouble $\ast$}]{fx, }
\item[{gdouble $\ast$}]{fy, }
\item[{gdouble $\ast$}]{fz, }
\item[{gint}]{nq, }
\item[{gdouble $\ast$}]{cfft, }
\item[{gint}]{cstr, }
\item[{gdouble $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__expansions_ga6d076ca091d09df650a755196e85c60f}


Generation of singular expansion coefficients for point dipole source. 


\begin{DoxyParams}{Parameters}
{\em k} & wavenumber; \\
\hline
{\em N} & order of expansion; \\
\hline
{\em x0} & centre of expansion; \\
\hline
{\em xs} & source position; \\
\hline
{\em fx} & component of complex source strength; \\
\hline
{\em fy} & component of complex source strength; \\
\hline
{\em fz} & component of complex source strength; \\
\hline
{\em nq} & number of source elements; \\
\hline
{\em cfft} & incremented with expansion coefficients; \\
\hline
{\em cstr} & stride in {\itshape cfft}, in number of complex elements; \\
\hline
{\em work} & workspace\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Generation and evaluation of expansions@{Generation and evaluation of expansions}!wbfmm\+\_\+expansion\+\_\+dipole\+\_\+h\+\_\+cfft\+\_\+f@{wbfmm\+\_\+expansion\+\_\+dipole\+\_\+h\+\_\+cfft\+\_\+f}}
\index{wbfmm\+\_\+expansion\+\_\+dipole\+\_\+h\+\_\+cfft\+\_\+f@{wbfmm\+\_\+expansion\+\_\+dipole\+\_\+h\+\_\+cfft\+\_\+f}!Generation and evaluation of expansions@{Generation and evaluation of expansions}}
\subsubsection[{wbfmm\+\_\+expansion\+\_\+dipole\+\_\+h\+\_\+cfft\+\_\+f}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+expansion\+\_\+dipole\+\_\+h\+\_\+cfft\+\_\+f (
\begin{DoxyParamCaption}
\item[{gfloat}]{k, }
\item[{gint}]{N, }
\item[{gfloat $\ast$}]{x0, }
\item[{gfloat $\ast$}]{xs, }
\item[{gfloat $\ast$}]{fx, }
\item[{gfloat $\ast$}]{fy, }
\item[{gfloat $\ast$}]{fz, }
\item[{gint}]{nq, }
\item[{gfloat $\ast$}]{cfft, }
\item[{gint}]{cstr, }
\item[{gfloat $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__expansions_ga8dd610fb6102ce0df359b4fa0967f01a}


Generation of singular expansion coefficients for point dipole source. 


\begin{DoxyParams}{Parameters}
{\em k} & wavenumber; \\
\hline
{\em N} & order of expansion; \\
\hline
{\em x0} & centre of expansion; \\
\hline
{\em xs} & source position; \\
\hline
{\em fx} & component of complex source strength; \\
\hline
{\em fy} & component of complex source strength; \\
\hline
{\em fz} & component of complex source strength; \\
\hline
{\em nq} & number of source elements; \\
\hline
{\em cfft} & incremented with expansion coefficients; \\
\hline
{\em cstr} & stride in {\itshape cfft}, in number of complex elements; \\
\hline
{\em work} & workspace\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Generation and evaluation of expansions@{Generation and evaluation of expansions}!wbfmm\+\_\+expansion\+\_\+h\+\_\+cfft@{wbfmm\+\_\+expansion\+\_\+h\+\_\+cfft}}
\index{wbfmm\+\_\+expansion\+\_\+h\+\_\+cfft@{wbfmm\+\_\+expansion\+\_\+h\+\_\+cfft}!Generation and evaluation of expansions@{Generation and evaluation of expansions}}
\subsubsection[{wbfmm\+\_\+expansion\+\_\+h\+\_\+cfft}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+expansion\+\_\+h\+\_\+cfft (
\begin{DoxyParamCaption}
\item[{gdouble}]{k, }
\item[{gint}]{N, }
\item[{gdouble $\ast$}]{x0, }
\item[{gdouble $\ast$}]{xs, }
\item[{gdouble $\ast$}]{q, }
\item[{gint}]{nq, }
\item[{gdouble $\ast$}]{cfft, }
\item[{gint}]{cstr, }
\item[{gdouble $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__expansions_gab7f021617751991c28566db91fdef72b}


Generation of singular expansion coefficients for point source. 


\begin{DoxyParams}{Parameters}
{\em k} & wavenumber; \\
\hline
{\em N} & order of expansion; \\
\hline
{\em x0} & centre of expansion; \\
\hline
{\em xs} & source position; \\
\hline
{\em q} & complex source strength; \\
\hline
{\em nq} & number of source elements; \\
\hline
{\em cfft} & incremented with expansion coefficients; \\
\hline
{\em cstr} & stride in {\itshape cfft}, in number of complex elements; \\
\hline
{\em work} & workspace\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Generation and evaluation of expansions@{Generation and evaluation of expansions}!wbfmm\+\_\+expansion\+\_\+h\+\_\+cfft\+\_\+f@{wbfmm\+\_\+expansion\+\_\+h\+\_\+cfft\+\_\+f}}
\index{wbfmm\+\_\+expansion\+\_\+h\+\_\+cfft\+\_\+f@{wbfmm\+\_\+expansion\+\_\+h\+\_\+cfft\+\_\+f}!Generation and evaluation of expansions@{Generation and evaluation of expansions}}
\subsubsection[{wbfmm\+\_\+expansion\+\_\+h\+\_\+cfft\+\_\+f}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+expansion\+\_\+h\+\_\+cfft\+\_\+f (
\begin{DoxyParamCaption}
\item[{gfloat}]{k, }
\item[{gint}]{N, }
\item[{gfloat $\ast$}]{x0, }
\item[{gfloat $\ast$}]{xs, }
\item[{gfloat $\ast$}]{q, }
\item[{gint}]{nq, }
\item[{gfloat $\ast$}]{cfft, }
\item[{gint}]{cstr, }
\item[{gfloat $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__expansions_ga9f70b3fc245b3e3fcc94dc128fb0fa5c}


Generation of singular expansion coefficients for point source. 


\begin{DoxyParams}{Parameters}
{\em k} & wavenumber; \\
\hline
{\em N} & order of expansion; \\
\hline
{\em x0} & centre of expansion; \\
\hline
{\em xs} & source position; \\
\hline
{\em q} & complex source strength; \\
\hline
{\em nq} & number of source elements; \\
\hline
{\em cfft} & incremented with expansion coefficients; \\
\hline
{\em cstr} & stride in {\itshape cfft}, in number of complex elements; \\
\hline
{\em work} & workspace\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Generation and evaluation of expansions@{Generation and evaluation of expansions}!wbfmm\+\_\+expansion\+\_\+h\+\_\+evaluate@{wbfmm\+\_\+expansion\+\_\+h\+\_\+evaluate}}
\index{wbfmm\+\_\+expansion\+\_\+h\+\_\+evaluate@{wbfmm\+\_\+expansion\+\_\+h\+\_\+evaluate}!Generation and evaluation of expansions@{Generation and evaluation of expansions}}
\subsubsection[{wbfmm\+\_\+expansion\+\_\+h\+\_\+evaluate}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+expansion\+\_\+h\+\_\+evaluate (
\begin{DoxyParamCaption}
\item[{gdouble}]{k, }
\item[{gdouble $\ast$}]{x0, }
\item[{gdouble $\ast$}]{cfft, }
\item[{gint}]{cstr, }
\item[{gint}]{N, }
\item[{gint}]{nq, }
\item[{gdouble $\ast$}]{xf, }
\item[{gdouble $\ast$}]{field, }
\item[{gint}]{fstr, }
\item[{gdouble $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__expansions_gaaf42f51f76f5c33eb66ac52cb46c09b9}


Evaluate a singular expansion. 


\begin{DoxyParams}{Parameters}
{\em k} & wavenumber; \\
\hline
{\em x0} & centre of expansion; \\
\hline
{\em cfft} & expansion coefficients; \\
\hline
{\em cstr} & stride in {\itshape cfft}, in number of complex elements; \\
\hline
{\em nq} & number of source elements; \\
\hline
{\em N} & order of expansion; \\
\hline
{\em xf} & field point; \\
\hline
{\em field} & incremented with computed field; \\
\hline
{\em fstr} & stride in {\itshape field}, in number of array entries; \\
\hline
{\em work} & workspace\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Generation and evaluation of expansions@{Generation and evaluation of expansions}!wbfmm\+\_\+expansion\+\_\+h\+\_\+evaluate\+\_\+f@{wbfmm\+\_\+expansion\+\_\+h\+\_\+evaluate\+\_\+f}}
\index{wbfmm\+\_\+expansion\+\_\+h\+\_\+evaluate\+\_\+f@{wbfmm\+\_\+expansion\+\_\+h\+\_\+evaluate\+\_\+f}!Generation and evaluation of expansions@{Generation and evaluation of expansions}}
\subsubsection[{wbfmm\+\_\+expansion\+\_\+h\+\_\+evaluate\+\_\+f}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+expansion\+\_\+h\+\_\+evaluate\+\_\+f (
\begin{DoxyParamCaption}
\item[{gfloat}]{k, }
\item[{gfloat $\ast$}]{x0, }
\item[{gfloat $\ast$}]{cfft, }
\item[{gint}]{cstr, }
\item[{gint}]{N, }
\item[{gint}]{nq, }
\item[{gfloat $\ast$}]{xf, }
\item[{gfloat $\ast$}]{field, }
\item[{gint}]{fstr, }
\item[{gfloat $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__expansions_ga8c57a7c0da561601523f734b3c16eea1}


Evaluate a singular expansion. 


\begin{DoxyParams}{Parameters}
{\em k} & wavenumber; \\
\hline
{\em x0} & centre of expansion; \\
\hline
{\em cfft} & expansion coefficients; \\
\hline
{\em cstr} & stride in {\itshape cfft}, in number of complex elements; \\
\hline
{\em nq} & number of source elements; \\
\hline
{\em N} & order of expansion; \\
\hline
{\em xf} & field point; \\
\hline
{\em field} & incremented with computed field; \\
\hline
{\em fstr} & stride in {\itshape field}, in number of array entries; \\
\hline
{\em work} & workspace\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Generation and evaluation of expansions@{Generation and evaluation of expansions}!wbfmm\+\_\+expansion\+\_\+h\+\_\+grad\+\_\+evaluate@{wbfmm\+\_\+expansion\+\_\+h\+\_\+grad\+\_\+evaluate}}
\index{wbfmm\+\_\+expansion\+\_\+h\+\_\+grad\+\_\+evaluate@{wbfmm\+\_\+expansion\+\_\+h\+\_\+grad\+\_\+evaluate}!Generation and evaluation of expansions@{Generation and evaluation of expansions}}
\subsubsection[{wbfmm\+\_\+expansion\+\_\+h\+\_\+grad\+\_\+evaluate}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+expansion\+\_\+h\+\_\+grad\+\_\+evaluate (
\begin{DoxyParamCaption}
\item[{gdouble}]{k, }
\item[{gdouble $\ast$}]{x0, }
\item[{gdouble $\ast$}]{cfft, }
\item[{gint}]{cstr, }
\item[{gint}]{N, }
\item[{gint}]{nq, }
\item[{gdouble $\ast$}]{xf, }
\item[{gdouble $\ast$}]{field, }
\item[{gdouble $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__expansions_ga908f9ce89e6a34a655f5b6de79e2bfa7}


Evaluate the gradient of a singular expansion. 


\begin{DoxyParams}{Parameters}
{\em k} & wavenumber; \\
\hline
{\em x0} & centre of expansion; \\
\hline
{\em cfft} & expansion coefficients; \\
\hline
{\em cstr} & stride in {\itshape cfft}, in number of complex elements; \\
\hline
{\em N} & order of expansion; \\
\hline
{\em nq} & number of source elements; \\
\hline
{\em xf} & field point; \\
\hline
{\em field} & incremented with computed gradient; \\
\hline
{\em work} & workspace\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Generation and evaluation of expansions@{Generation and evaluation of expansions}!wbfmm\+\_\+expansion\+\_\+h\+\_\+grad\+\_\+evaluate\+\_\+f@{wbfmm\+\_\+expansion\+\_\+h\+\_\+grad\+\_\+evaluate\+\_\+f}}
\index{wbfmm\+\_\+expansion\+\_\+h\+\_\+grad\+\_\+evaluate\+\_\+f@{wbfmm\+\_\+expansion\+\_\+h\+\_\+grad\+\_\+evaluate\+\_\+f}!Generation and evaluation of expansions@{Generation and evaluation of expansions}}
\subsubsection[{wbfmm\+\_\+expansion\+\_\+h\+\_\+grad\+\_\+evaluate\+\_\+f}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+expansion\+\_\+h\+\_\+grad\+\_\+evaluate\+\_\+f (
\begin{DoxyParamCaption}
\item[{gfloat}]{k, }
\item[{gfloat $\ast$}]{x0, }
\item[{gfloat $\ast$}]{cfft, }
\item[{gint}]{cstr, }
\item[{gint}]{N, }
\item[{gint}]{nq, }
\item[{gfloat $\ast$}]{xf, }
\item[{gfloat $\ast$}]{field, }
\item[{gfloat $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__expansions_ga187d9da79f4b197559fa8a5a74f8c6d0}


Evaluate the gradient of a singular expansion. 


\begin{DoxyParams}{Parameters}
{\em k} & wavenumber; \\
\hline
{\em x0} & centre of expansion; \\
\hline
{\em cfft} & expansion coefficients; \\
\hline
{\em cstr} & stride in {\itshape cfft}, in number of complex elements; \\
\hline
{\em N} & order of expansion; \\
\hline
{\em nq} & number of source elements; \\
\hline
{\em xf} & field point; \\
\hline
{\em field} & incremented with computed gradient; \\
\hline
{\em work} & workspace\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Generation and evaluation of expansions@{Generation and evaluation of expansions}!wbfmm\+\_\+expansion\+\_\+j\+\_\+evaluate@{wbfmm\+\_\+expansion\+\_\+j\+\_\+evaluate}}
\index{wbfmm\+\_\+expansion\+\_\+j\+\_\+evaluate@{wbfmm\+\_\+expansion\+\_\+j\+\_\+evaluate}!Generation and evaluation of expansions@{Generation and evaluation of expansions}}
\subsubsection[{wbfmm\+\_\+expansion\+\_\+j\+\_\+evaluate}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+expansion\+\_\+j\+\_\+evaluate (
\begin{DoxyParamCaption}
\item[{gdouble}]{k, }
\item[{gdouble $\ast$}]{x0, }
\item[{gdouble $\ast$}]{cfft, }
\item[{gint}]{cstr, }
\item[{gint}]{nq, }
\item[{gint}]{N, }
\item[{gdouble $\ast$}]{xf, }
\item[{gdouble $\ast$}]{field, }
\item[{gint}]{fstr, }
\item[{gdouble $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__expansions_ga982f9c432c30fc81403f28c004778d8b}


Evaluate a regular expansion. 


\begin{DoxyParams}{Parameters}
{\em k} & wavenumber; \\
\hline
{\em x0} & centre of expansion; \\
\hline
{\em cfft} & expansion coefficients; \\
\hline
{\em cstr} & stride in {\itshape cfft}, in number of complex elements; \\
\hline
{\em nq} & number of source elements; \\
\hline
{\em N} & order of expansion; \\
\hline
{\em xf} & field point; \\
\hline
{\em field} & incremented with computed field; \\
\hline
{\em fstr} & stride in {\itshape field} in number of array entries; \\
\hline
{\em work} & workspace\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Generation and evaluation of expansions@{Generation and evaluation of expansions}!wbfmm\+\_\+expansion\+\_\+j\+\_\+evaluate\+\_\+f@{wbfmm\+\_\+expansion\+\_\+j\+\_\+evaluate\+\_\+f}}
\index{wbfmm\+\_\+expansion\+\_\+j\+\_\+evaluate\+\_\+f@{wbfmm\+\_\+expansion\+\_\+j\+\_\+evaluate\+\_\+f}!Generation and evaluation of expansions@{Generation and evaluation of expansions}}
\subsubsection[{wbfmm\+\_\+expansion\+\_\+j\+\_\+evaluate\+\_\+f}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+expansion\+\_\+j\+\_\+evaluate\+\_\+f (
\begin{DoxyParamCaption}
\item[{gfloat}]{k, }
\item[{gfloat $\ast$}]{x0, }
\item[{gfloat $\ast$}]{cfft, }
\item[{gint}]{cstr, }
\item[{gint}]{nq, }
\item[{gint}]{N, }
\item[{gfloat $\ast$}]{xf, }
\item[{gfloat $\ast$}]{field, }
\item[{gint}]{fstr, }
\item[{gfloat $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__expansions_ga83d0ee00089d4d1a520c1063b161d865}


Evaluate a regular expansion. 


\begin{DoxyParams}{Parameters}
{\em k} & wavenumber; \\
\hline
{\em x0} & centre of expansion; \\
\hline
{\em cfft} & expansion coefficients; \\
\hline
{\em cstr} & stride in {\itshape cfft}, in number of complex elements; \\
\hline
{\em nq} & number of source elements; \\
\hline
{\em N} & order of expansion; \\
\hline
{\em xf} & field point; \\
\hline
{\em field} & incremented with computed field; \\
\hline
{\em fstr} & stride in {\itshape field} in number of array entries; \\
\hline
{\em work} & workspace\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Generation and evaluation of expansions@{Generation and evaluation of expansions}!wbfmm\+\_\+expansion\+\_\+j\+\_\+grad\+\_\+evaluate@{wbfmm\+\_\+expansion\+\_\+j\+\_\+grad\+\_\+evaluate}}
\index{wbfmm\+\_\+expansion\+\_\+j\+\_\+grad\+\_\+evaluate@{wbfmm\+\_\+expansion\+\_\+j\+\_\+grad\+\_\+evaluate}!Generation and evaluation of expansions@{Generation and evaluation of expansions}}
\subsubsection[{wbfmm\+\_\+expansion\+\_\+j\+\_\+grad\+\_\+evaluate}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+expansion\+\_\+j\+\_\+grad\+\_\+evaluate (
\begin{DoxyParamCaption}
\item[{gdouble}]{k, }
\item[{gdouble $\ast$}]{x0, }
\item[{gdouble $\ast$}]{cfft, }
\item[{gint}]{cstr, }
\item[{gint}]{N, }
\item[{gint}]{nq, }
\item[{gdouble $\ast$}]{xf, }
\item[{gdouble $\ast$}]{field, }
\item[{gint}]{fstr, }
\item[{gdouble $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__expansions_ga89f2aa927b3103c66b6cd3f8f1537dbe}


Evaluate the gradient of a regular expansion. 


\begin{DoxyParams}{Parameters}
{\em k} & wavenumber; \\
\hline
{\em x0} & centre of expansion; \\
\hline
{\em cfft} & expansion coefficients; \\
\hline
{\em cstr} & stride in {\itshape cfft}, in number of complex elements; \\
\hline
{\em N} & order of expansion; \\
\hline
{\em nq} & number of source elements; \\
\hline
{\em xf} & field point; \\
\hline
{\em field} & incremented with computed gradient; \\
\hline
{\em work} & workspace\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Generation and evaluation of expansions@{Generation and evaluation of expansions}!wbfmm\+\_\+expansion\+\_\+j\+\_\+grad\+\_\+evaluate\+\_\+f@{wbfmm\+\_\+expansion\+\_\+j\+\_\+grad\+\_\+evaluate\+\_\+f}}
\index{wbfmm\+\_\+expansion\+\_\+j\+\_\+grad\+\_\+evaluate\+\_\+f@{wbfmm\+\_\+expansion\+\_\+j\+\_\+grad\+\_\+evaluate\+\_\+f}!Generation and evaluation of expansions@{Generation and evaluation of expansions}}
\subsubsection[{wbfmm\+\_\+expansion\+\_\+j\+\_\+grad\+\_\+evaluate\+\_\+f}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+expansion\+\_\+j\+\_\+grad\+\_\+evaluate\+\_\+f (
\begin{DoxyParamCaption}
\item[{gfloat}]{k, }
\item[{gfloat $\ast$}]{x0, }
\item[{gfloat $\ast$}]{cfft, }
\item[{gint}]{cstr, }
\item[{gint}]{N, }
\item[{gint}]{nq, }
\item[{gfloat $\ast$}]{xf, }
\item[{gfloat $\ast$}]{field, }
\item[{gint}]{fstr, }
\item[{gfloat $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__expansions_ga2bc48b9256dade59e88e6f5100b0ef6c}


Evaluate the gradient of a regular expansion. 


\begin{DoxyParams}{Parameters}
{\em k} & wavenumber; \\
\hline
{\em x0} & centre of expansion; \\
\hline
{\em cfft} & expansion coefficients; \\
\hline
{\em cstr} & stride in {\itshape cfft}, in number of complex elements; \\
\hline
{\em N} & order of expansion; \\
\hline
{\em nq} & number of source elements; \\
\hline
{\em xf} & field point; \\
\hline
{\em field} & incremented with computed gradient; \\
\hline
{\em work} & workspace\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Generation and evaluation of expansions@{Generation and evaluation of expansions}!wbfmm\+\_\+expansion\+\_\+normal\+\_\+h\+\_\+cfft@{wbfmm\+\_\+expansion\+\_\+normal\+\_\+h\+\_\+cfft}}
\index{wbfmm\+\_\+expansion\+\_\+normal\+\_\+h\+\_\+cfft@{wbfmm\+\_\+expansion\+\_\+normal\+\_\+h\+\_\+cfft}!Generation and evaluation of expansions@{Generation and evaluation of expansions}}
\subsubsection[{wbfmm\+\_\+expansion\+\_\+normal\+\_\+h\+\_\+cfft}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+expansion\+\_\+normal\+\_\+h\+\_\+cfft (
\begin{DoxyParamCaption}
\item[{gdouble}]{k, }
\item[{gint}]{N, }
\item[{gdouble $\ast$}]{x0, }
\item[{gdouble $\ast$}]{xs, }
\item[{gdouble $\ast$}]{normal, }
\item[{gdouble $\ast$}]{q, }
\item[{gint}]{nq, }
\item[{gdouble $\ast$}]{cfft, }
\item[{gint}]{cstr, }
\item[{gdouble $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__expansions_gae53cb9a080080b1c72a4bea0776453a1}


Generation of singular expansion coefficients for point dipole source defined as normal and strength. 


\begin{DoxyParams}{Parameters}
{\em k} & wavenumber; \\
\hline
{\em N} & order of expansion; \\
\hline
{\em x0} & centre of expansion; \\
\hline
{\em xs} & source position; \\
\hline
{\em normal} & normal vector for source orientation; \\
\hline
{\em q} & complex source strength; \\
\hline
{\em nq} & number of source elements; \\
\hline
{\em cfft} & incremented with expansion coefficients; \\
\hline
{\em cstr} & stride in {\itshape cfft}, in number of complex elements; \\
\hline
{\em nq} & number of source elements; \\
\hline
{\em work} & workspace\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\index{Generation and evaluation of expansions@{Generation and evaluation of expansions}!wbfmm\+\_\+expansion\+\_\+normal\+\_\+h\+\_\+cfft\+\_\+f@{wbfmm\+\_\+expansion\+\_\+normal\+\_\+h\+\_\+cfft\+\_\+f}}
\index{wbfmm\+\_\+expansion\+\_\+normal\+\_\+h\+\_\+cfft\+\_\+f@{wbfmm\+\_\+expansion\+\_\+normal\+\_\+h\+\_\+cfft\+\_\+f}!Generation and evaluation of expansions@{Generation and evaluation of expansions}}
\subsubsection[{wbfmm\+\_\+expansion\+\_\+normal\+\_\+h\+\_\+cfft\+\_\+f}]{\setlength{\rightskip}{0pt plus 5cm}gint wbfmm\+\_\+expansion\+\_\+normal\+\_\+h\+\_\+cfft\+\_\+f (
\begin{DoxyParamCaption}
\item[{gfloat}]{k, }
\item[{gint}]{N, }
\item[{gfloat $\ast$}]{x0, }
\item[{gfloat $\ast$}]{xs, }
\item[{gfloat $\ast$}]{normal, }
\item[{gfloat $\ast$}]{q, }
\item[{gint}]{nq, }
\item[{gfloat $\ast$}]{cfft, }
\item[{gint}]{cstr, }
\item[{gfloat $\ast$}]{work}
\end{DoxyParamCaption}
)}\label{group__expansions_ga6fe41b2e22177a33742d47998ecde8f0}


Generation of singular expansion coefficients for point dipole source defined as normal and strength. 


\begin{DoxyParams}{Parameters}
{\em k} & wavenumber; \\
\hline
{\em N} & order of expansion; \\
\hline
{\em x0} & centre of expansion; \\
\hline
{\em xs} & source position; \\
\hline
{\em normal} & normal vector for source orientation; \\
\hline
{\em q} & complex source strength; \\
\hline
{\em nq} & number of source elements; \\
\hline
{\em cfft} & incremented with expansion coefficients; \\
\hline
{\em cstr} & stride in {\itshape cfft}, in number of complex elements; \\
\hline
{\em nq} & number of source elements; \\
\hline
{\em work} & workspace\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
