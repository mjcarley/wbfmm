\doxysection{Utility and convenience functions}
\label{group__util}\index{Utility and convenience functions@{Utility and convenience functions}}


Various functions of use in debugging or underlying utilities.  


\doxysubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \textbf{ wbfmm\+\_\+library\+\_\+config\+\_\+t}
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
gint \textbf{ wbfmm\+\_\+cartesian\+\_\+to\+\_\+spherical} (gdouble $\ast$x0, gdouble $\ast$x, gdouble $\ast$r, gdouble $\ast$th, gdouble $\ast$ph)
\begin{DoxyCompactList}\small\item\em Convert Cartesian to spherical coordinates $(r,\theta,\phi)$. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+legendre\+\_\+recursion\+\_\+array} (gdouble $\ast$$\ast$Pnm1, gdouble $\ast$$\ast$Pn, gint n, gdouble C, gdouble S)
\begin{DoxyCompactList}\small\item\em Perform recursion on normalized associated Legendre functions. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+legendre\+\_\+init} (gdouble C, gdouble S, gdouble $\ast$P0, gdouble $\ast$P10, gdouble $\ast$P11)
\begin{DoxyCompactList}\small\item\em Initialize normalized associated Legendre functions. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+bessel\+\_\+j\+\_\+recursion} (gdouble $\ast$jnm1, gdouble $\ast$jn, gdouble x, gint n)
\begin{DoxyCompactList}\small\item\em Perform recursion on spherical Bessel function $j_{n}(x)$. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+bessel\+\_\+j\+\_\+init} (gdouble x, gdouble $\ast$j0, gdouble $\ast$j1)
\begin{DoxyCompactList}\small\item\em Initialize the spherical Bessel function recursion. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+bessel\+\_\+h\+\_\+init} (gdouble x, gdouble $\ast$h0, gdouble $\ast$h1)
\begin{DoxyCompactList}\small\item\em Initialize spherical Hankel function recursion. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+bessel\+\_\+h\+\_\+recursion} (gdouble $\ast$hnm1, gdouble $\ast$hn, gdouble x, gint n)
\begin{DoxyCompactList}\small\item\em Perform one step of spherical Hankel recursion. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+total\+\_\+dipole\+\_\+field} (gdouble k, gdouble $\ast$xs, gint xstride, gdouble $\ast$src, gint sstride, gint nsrc, gdouble $\ast$xf, gdouble $\ast$field)
\begin{DoxyCompactList}\small\item\em Compute total field from dipole sources by direct evaluation. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+total\+\_\+field} (gdouble k, gdouble $\ast$xs, gint xstride, gdouble $\ast$src, gint sstride, gint nq, gint nsrc, gdouble $\ast$xf, gdouble $\ast$field, gint fstr)
\begin{DoxyCompactList}\small\item\em Compute total field by direct evaluation. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+coordinate\+\_\+transform} (gdouble $\ast$x, gdouble $\ast$ix, gdouble $\ast$iy, gdouble $\ast$iz, gdouble $\ast$y)
\begin{DoxyCompactList}\small\item\em Transform coordinates to rotated axes. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+shift\+\_\+coordinates} (gdouble $\ast$x, gdouble $\ast$y, gdouble $\ast$ix, gdouble $\ast$iy, gdouble $\ast$iz, gdouble $\ast$r)
\begin{DoxyCompactList}\small\item\em Find system of axes for coordinate shift. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+box\+\_\+location\+\_\+from\+\_\+index} (guint64 idx, guint32 level, gdouble $\ast$x0, gdouble D, gdouble $\ast$x, gdouble $\ast$wb)
\begin{DoxyCompactList}\small\item\em Find the coordinates of a box from its Morton index. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+tree\+\_\+box\+\_\+centre} (\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$t, guint32 level, guint64 b, gdouble $\ast$xb, gdouble $\ast$wb)
\begin{DoxyCompactList}\small\item\em Find centre and width of box in an octree. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+points\+\_\+origin\+\_\+width} (gdouble $\ast$x, gint str, gint n, gdouble $\ast$xmin, gdouble $\ast$D, gboolean init\+\_\+limits)
\begin{DoxyCompactList}\small\item\em Find limits of a cube containing a set of points. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+shift\+\_\+angles} (gdouble $\ast$xi, gdouble $\ast$xj, gdouble $\ast$th, gdouble $\ast$ph, gdouble $\ast$ch, gdouble $\ast$r)
\begin{DoxyCompactList}\small\item\em Compute angles and distance to shift expansion between two points. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+tree\+\_\+write\+\_\+sources} (\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$t, gdouble $\ast$q, gint stride, FILE $\ast$f)
\begin{DoxyCompactList}\small\item\em Write a tree source list to file. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+cartesian\+\_\+to\+\_\+spherical\+\_\+f} (gfloat $\ast$x0, gfloat $\ast$x, gfloat $\ast$r, gfloat $\ast$th, gfloat $\ast$ph)
\begin{DoxyCompactList}\small\item\em Convert Cartesian to spherical coordinates $(r,\theta,\phi)$. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+legendre\+\_\+recursion\+\_\+array\+\_\+f} (gfloat $\ast$$\ast$Pnm1, gfloat $\ast$$\ast$Pn, gint n, gfloat C, gfloat S)
\begin{DoxyCompactList}\small\item\em Perform recursion on normalized associated Legendre functions. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+legendre\+\_\+init\+\_\+f} (gfloat C, gfloat S, gfloat $\ast$P0, gfloat $\ast$P10, gfloat $\ast$P11)
\begin{DoxyCompactList}\small\item\em Initialize normalized associated Legendre functions. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+bessel\+\_\+j\+\_\+recursion\+\_\+f} (gfloat $\ast$jnm1, gfloat $\ast$jn, gfloat x, gint n)
\begin{DoxyCompactList}\small\item\em Perform recursion on spherical Bessel function $j_{n}(x)$. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+bessel\+\_\+j\+\_\+init\+\_\+f} (gfloat x, gfloat $\ast$j0, gfloat $\ast$j1)
\begin{DoxyCompactList}\small\item\em Initialize the spherical Bessel function recursion. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+bessel\+\_\+h\+\_\+init\+\_\+f} (gfloat x, gfloat $\ast$h0, gfloat $\ast$h1)
\begin{DoxyCompactList}\small\item\em Initialize spherical Hankel function recursion. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+bessel\+\_\+h\+\_\+recursion\+\_\+f} (gfloat $\ast$hnm1, gfloat $\ast$hn, gfloat x, gint n)
\begin{DoxyCompactList}\small\item\em Perform one step of spherical Hankel recursion. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+total\+\_\+dipole\+\_\+field\+\_\+f} (gfloat k, gfloat $\ast$xs, gint xstride, gfloat $\ast$src, gint sstride, gint nsrc, gfloat $\ast$xf, gfloat $\ast$field)
\begin{DoxyCompactList}\small\item\em Compute total field from dipole sources by direct evaluation. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+total\+\_\+field\+\_\+f} (gfloat k, gfloat $\ast$xs, gint xstride, gfloat $\ast$src, gint sstride, gint nq, gint nsrc, gfloat $\ast$xf, gfloat $\ast$field, gint fstr)
\begin{DoxyCompactList}\small\item\em Compute total field by direct evaluation. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+coordinate\+\_\+transform\+\_\+f} (gfloat $\ast$x, gfloat $\ast$ix, gfloat $\ast$iy, gfloat $\ast$iz, gfloat $\ast$y)
\begin{DoxyCompactList}\small\item\em Transform coordinates to rotated axes. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+shift\+\_\+coordinates\+\_\+f} (gfloat $\ast$x, gfloat $\ast$y, gfloat $\ast$ix, gfloat $\ast$iy, gfloat $\ast$iz, gfloat $\ast$r)
\begin{DoxyCompactList}\small\item\em Find system of axes for coordinate shift. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+box\+\_\+location\+\_\+from\+\_\+index\+\_\+f} (guint64 idx, guint32 level, gfloat $\ast$x0, gfloat D, gfloat $\ast$x, gfloat $\ast$wb)
\begin{DoxyCompactList}\small\item\em Find the coordinates of a box from its Morton index. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+tree\+\_\+box\+\_\+centre\+\_\+f} (\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$t, guint32 level, guint64 b, gfloat $\ast$xb, gfloat $\ast$wb)
\begin{DoxyCompactList}\small\item\em Find centre and width of box in an octree. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+points\+\_\+origin\+\_\+width\+\_\+f} (gfloat $\ast$x, gint str, gint n, gfloat $\ast$xmin, gfloat $\ast$D, gboolean init\+\_\+limits)
\begin{DoxyCompactList}\small\item\em Find limits of a cube containing a set of points. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+shift\+\_\+angles\+\_\+f} (gfloat $\ast$xi, gfloat $\ast$xj, gfloat $\ast$th, gfloat $\ast$ph, gfloat $\ast$ch, gfloat $\ast$r)
\begin{DoxyCompactList}\small\item\em Compute angles and distance to shift expansion between two points. \end{DoxyCompactList}\item 
gint \textbf{ wbfmm\+\_\+tree\+\_\+write\+\_\+sources\+\_\+f} (\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$t, gfloat $\ast$q, gint stride, FILE $\ast$f)
\begin{DoxyCompactList}\small\item\em Write a tree source list to file. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Various functions of use in debugging or underlying utilities. 



\doxysubsection{Function Documentation}
\mbox{\label{group__util_ga5131dd2bf4e6cac0776e8a395b4cb580}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_bessel\_h\_init@{wbfmm\_bessel\_h\_init}}
\index{wbfmm\_bessel\_h\_init@{wbfmm\_bessel\_h\_init}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_bessel\_h\_init()}
{\footnotesize\ttfamily gint wbfmm\+\_\+bessel\+\_\+h\+\_\+init (\begin{DoxyParamCaption}\item[{gdouble}]{x,  }\item[{gdouble $\ast$}]{h0,  }\item[{gdouble $\ast$}]{h1 }\end{DoxyParamCaption})}



Initialize spherical Hankel function recursion. 


\begin{DoxyParams}{Parameters}
{\em x} & argument of $h_{n}(x)$; \\
\hline
{\em h0} & on exit $h_{0}(x)$; \\
\hline
{\em h1} & on exit $h_{1}(x)$\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_gaf74338e3e21540953ed71f07a01a3915}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_bessel\_h\_init\_f@{wbfmm\_bessel\_h\_init\_f}}
\index{wbfmm\_bessel\_h\_init\_f@{wbfmm\_bessel\_h\_init\_f}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_bessel\_h\_init\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+bessel\+\_\+h\+\_\+init\+\_\+f (\begin{DoxyParamCaption}\item[{gfloat}]{x,  }\item[{gfloat $\ast$}]{h0,  }\item[{gfloat $\ast$}]{h1 }\end{DoxyParamCaption})}



Initialize spherical Hankel function recursion. 


\begin{DoxyParams}{Parameters}
{\em x} & argument of $h_{n}(x)$; \\
\hline
{\em h0} & on exit $h_{0}(x)$; \\
\hline
{\em h1} & on exit $h_{1}(x)$\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_ga8518f148a22a13875c7a21bd15c1d6fc}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_bessel\_h\_recursion@{wbfmm\_bessel\_h\_recursion}}
\index{wbfmm\_bessel\_h\_recursion@{wbfmm\_bessel\_h\_recursion}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_bessel\_h\_recursion()}
{\footnotesize\ttfamily gint wbfmm\+\_\+bessel\+\_\+h\+\_\+recursion (\begin{DoxyParamCaption}\item[{gdouble $\ast$}]{hnm1,  }\item[{gdouble $\ast$}]{hn,  }\item[{gdouble}]{x,  }\item[{gint}]{n }\end{DoxyParamCaption})}



Perform one step of spherical Hankel recursion. 

Perform one step of the spherical Hankel function recursion. On entry {\itshape hnm1} and {\itshape hnm} contain $h_{n-1}(x)$ and $h_{n}(x)$ respectively. On exit they contain equivalent values but for $n$ incremented by one. When $x$ falls below a small order-\/dependent cutoff, where the recursion is unreliable, $h_{n}(x)$ is computed directly using a power series.


\begin{DoxyParams}{Parameters}
{\em hnm1} & $h_{n-1}(x)$; \\
\hline
{\em hn} & $h_{n}(x)$; \\
\hline
{\em x} & argument of spherical Hankel function; \\
\hline
{\em n} & order of spherical Hankel function\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_gaad7da6548d4f943fd19c61661aafec92}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_bessel\_h\_recursion\_f@{wbfmm\_bessel\_h\_recursion\_f}}
\index{wbfmm\_bessel\_h\_recursion\_f@{wbfmm\_bessel\_h\_recursion\_f}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_bessel\_h\_recursion\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+bessel\+\_\+h\+\_\+recursion\+\_\+f (\begin{DoxyParamCaption}\item[{gfloat $\ast$}]{hnm1,  }\item[{gfloat $\ast$}]{hn,  }\item[{gfloat}]{x,  }\item[{gint}]{n }\end{DoxyParamCaption})}



Perform one step of spherical Hankel recursion. 

Perform one step of the spherical Hankel function recursion. On entry {\itshape hnm1} and {\itshape hnm} contain $h_{n-1}(x)$ and $h_{n}(x)$ respectively. On exit they contain equivalent values but for $n$ incremented by one. When $x$ falls below a small order-\/dependent cutoff, where the recursion is unreliable, $h_{n}(x)$ is computed directly using a power series.


\begin{DoxyParams}{Parameters}
{\em hnm1} & $h_{n-1}(x)$; \\
\hline
{\em hn} & $h_{n}(x)$; \\
\hline
{\em x} & argument of spherical Hankel function; \\
\hline
{\em n} & order of spherical Hankel function\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_ga85a1d8464e958530fb4348d3a9f3ef0e}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_bessel\_j\_init@{wbfmm\_bessel\_j\_init}}
\index{wbfmm\_bessel\_j\_init@{wbfmm\_bessel\_j\_init}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_bessel\_j\_init()}
{\footnotesize\ttfamily gint wbfmm\+\_\+bessel\+\_\+j\+\_\+init (\begin{DoxyParamCaption}\item[{gdouble}]{x,  }\item[{gdouble $\ast$}]{j0,  }\item[{gdouble $\ast$}]{j1 }\end{DoxyParamCaption})}



Initialize the spherical Bessel function recursion. 


\begin{DoxyParams}{Parameters}
{\em x} & argument of $j_{n}(x)$; \\
\hline
{\em j0} & on exit $j_{0}(x)$; \\
\hline
{\em j1} & on exit $j_{1}(x)$\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_ga4a440d7cd040b7cbdcd5093de685ea0d}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_bessel\_j\_init\_f@{wbfmm\_bessel\_j\_init\_f}}
\index{wbfmm\_bessel\_j\_init\_f@{wbfmm\_bessel\_j\_init\_f}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_bessel\_j\_init\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+bessel\+\_\+j\+\_\+init\+\_\+f (\begin{DoxyParamCaption}\item[{gfloat}]{x,  }\item[{gfloat $\ast$}]{j0,  }\item[{gfloat $\ast$}]{j1 }\end{DoxyParamCaption})}



Initialize the spherical Bessel function recursion. 


\begin{DoxyParams}{Parameters}
{\em x} & argument of $j_{n}(x)$; \\
\hline
{\em j0} & on exit $j_{0}(x)$; \\
\hline
{\em j1} & on exit $j_{1}(x)$\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_gaa5316c151f2c3d259ad189c5dc42c6fe}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_bessel\_j\_recursion@{wbfmm\_bessel\_j\_recursion}}
\index{wbfmm\_bessel\_j\_recursion@{wbfmm\_bessel\_j\_recursion}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_bessel\_j\_recursion()}
{\footnotesize\ttfamily gint wbfmm\+\_\+bessel\+\_\+j\+\_\+recursion (\begin{DoxyParamCaption}\item[{gdouble $\ast$}]{jnm1,  }\item[{gdouble $\ast$}]{jn,  }\item[{gdouble}]{x,  }\item[{gint}]{n }\end{DoxyParamCaption})}



Perform recursion on spherical Bessel function $j_{n}(x)$. 

Perform one step of the spherical Bessel function recursion. On entry {\itshape jnm1} and {\itshape jnm} contain $j_{n-1}(x)$ and $j_{n}(x)$ respectively. On exit they contain equivalent values but for $n$ incremented by one. When $x$ falls below a small order-\/dependent cutoff, where the recursion is unreliable, $j_{n}(x)$ is computed directly using a power series.


\begin{DoxyParams}{Parameters}
{\em jnm1} & $j_{n-1}(x)$; \\
\hline
{\em jn} & $j_{n}(x)$; \\
\hline
{\em x} & argument of spherical Bessel function; \\
\hline
{\em n} & order of spherical Bessel function\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_ga8ef3a3514c59cdd91c89dc8cd608d17f}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_bessel\_j\_recursion\_f@{wbfmm\_bessel\_j\_recursion\_f}}
\index{wbfmm\_bessel\_j\_recursion\_f@{wbfmm\_bessel\_j\_recursion\_f}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_bessel\_j\_recursion\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+bessel\+\_\+j\+\_\+recursion\+\_\+f (\begin{DoxyParamCaption}\item[{gfloat $\ast$}]{jnm1,  }\item[{gfloat $\ast$}]{jn,  }\item[{gfloat}]{x,  }\item[{gint}]{n }\end{DoxyParamCaption})}



Perform recursion on spherical Bessel function $j_{n}(x)$. 

Perform one step of the spherical Bessel function recursion. On entry {\itshape jnm1} and {\itshape jnm} contain $j_{n-1}(x)$ and $j_{n}(x)$ respectively. On exit they contain equivalent values but for $n$ incremented by one. When $x$ falls below a small order-\/dependent cutoff, where the recursion is unreliable, $j_{n}(x)$ is computed directly using a power series.


\begin{DoxyParams}{Parameters}
{\em jnm1} & $j_{n-1}(x)$; \\
\hline
{\em jn} & $j_{n}(x)$; \\
\hline
{\em x} & argument of spherical Bessel function; \\
\hline
{\em n} & order of spherical Bessel function\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_ga1c0ed6621a323335f41fd6d36ef85012}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_box\_location\_from\_index@{wbfmm\_box\_location\_from\_index}}
\index{wbfmm\_box\_location\_from\_index@{wbfmm\_box\_location\_from\_index}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_box\_location\_from\_index()}
{\footnotesize\ttfamily gint wbfmm\+\_\+box\+\_\+location\+\_\+from\+\_\+index (\begin{DoxyParamCaption}\item[{guint64}]{idx,  }\item[{guint32}]{level,  }\item[{gdouble $\ast$}]{x0,  }\item[{gdouble}]{D,  }\item[{gdouble $\ast$}]{x,  }\item[{gdouble $\ast$}]{wb }\end{DoxyParamCaption})}



Find the coordinates of a box from its Morton index. 


\begin{DoxyParams}{Parameters}
{\em idx} & Morton index of box; \\
\hline
{\em level} & level in octree of box; \\
\hline
{\em x0} & origin of top-\/level box; \\
\hline
{\em D} & width of top-\/level box; \\
\hline
{\em x} & coordinates of box {\itshape idx} at level {\itshape level}; \\
\hline
{\em wb} & width of box at level {\itshape level} \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_ga1679d3cd7c5e843d557705ae4a937c54}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_box\_location\_from\_index\_f@{wbfmm\_box\_location\_from\_index\_f}}
\index{wbfmm\_box\_location\_from\_index\_f@{wbfmm\_box\_location\_from\_index\_f}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_box\_location\_from\_index\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+box\+\_\+location\+\_\+from\+\_\+index\+\_\+f (\begin{DoxyParamCaption}\item[{guint64}]{idx,  }\item[{guint32}]{level,  }\item[{gfloat $\ast$}]{x0,  }\item[{gfloat}]{D,  }\item[{gfloat $\ast$}]{x,  }\item[{gfloat $\ast$}]{wb }\end{DoxyParamCaption})}



Find the coordinates of a box from its Morton index. 


\begin{DoxyParams}{Parameters}
{\em idx} & Morton index of box; \\
\hline
{\em level} & level in octree of box; \\
\hline
{\em x0} & origin of top-\/level box; \\
\hline
{\em D} & width of top-\/level box; \\
\hline
{\em x} & coordinates of box {\itshape idx} at level {\itshape level}; \\
\hline
{\em wb} & width of box at level {\itshape level} \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_ga9d1295292204be6d9b3a27da092d2da6}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_cartesian\_to\_spherical@{wbfmm\_cartesian\_to\_spherical}}
\index{wbfmm\_cartesian\_to\_spherical@{wbfmm\_cartesian\_to\_spherical}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_cartesian\_to\_spherical()}
{\footnotesize\ttfamily gint wbfmm\+\_\+cartesian\+\_\+to\+\_\+spherical (\begin{DoxyParamCaption}\item[{gdouble $\ast$}]{x0,  }\item[{gdouble $\ast$}]{x,  }\item[{gdouble $\ast$}]{r,  }\item[{gdouble $\ast$}]{th,  }\item[{gdouble $\ast$}]{ph }\end{DoxyParamCaption})}



Convert Cartesian to spherical coordinates $(r,\theta,\phi)$. 


\begin{DoxyParams}{Parameters}
{\em x0} & centre of coordinate system; \\
\hline
{\em x} & point whose coordinates are to be found; \\
\hline
{\em r} & $r$; \\
\hline
{\em th} & $\theta$; \\
\hline
{\em ph} & $\phi$\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_gac4d5172c244d7af272ee8d79b977263d}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_cartesian\_to\_spherical\_f@{wbfmm\_cartesian\_to\_spherical\_f}}
\index{wbfmm\_cartesian\_to\_spherical\_f@{wbfmm\_cartesian\_to\_spherical\_f}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_cartesian\_to\_spherical\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+cartesian\+\_\+to\+\_\+spherical\+\_\+f (\begin{DoxyParamCaption}\item[{gfloat $\ast$}]{x0,  }\item[{gfloat $\ast$}]{x,  }\item[{gfloat $\ast$}]{r,  }\item[{gfloat $\ast$}]{th,  }\item[{gfloat $\ast$}]{ph }\end{DoxyParamCaption})}



Convert Cartesian to spherical coordinates $(r,\theta,\phi)$. 


\begin{DoxyParams}{Parameters}
{\em x0} & centre of coordinate system; \\
\hline
{\em x} & point whose coordinates are to be found; \\
\hline
{\em r} & $r$; \\
\hline
{\em th} & $\theta$; \\
\hline
{\em ph} & $\phi$\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_ga7ecc6ba469d53c16ec8830aba8992c90}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_coordinate\_transform@{wbfmm\_coordinate\_transform}}
\index{wbfmm\_coordinate\_transform@{wbfmm\_coordinate\_transform}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_coordinate\_transform()}
{\footnotesize\ttfamily gint wbfmm\+\_\+coordinate\+\_\+transform (\begin{DoxyParamCaption}\item[{gdouble $\ast$}]{x,  }\item[{gdouble $\ast$}]{ix,  }\item[{gdouble $\ast$}]{iy,  }\item[{gdouble $\ast$}]{iz,  }\item[{gdouble $\ast$}]{y }\end{DoxyParamCaption})}



Transform coordinates to rotated axes. 


\begin{DoxyParams}{Parameters}
{\em x} & point coordinates in original axes; \\
\hline
{\em ix} & unit vector in new axes; \\
\hline
{\em iy} & unit vector in new axes; \\
\hline
{\em iz} & unit vector in new axes; \\
\hline
{\em y} & point coordinates in new axes\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_ga18c92e292152fe38088188204556089a}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_coordinate\_transform\_f@{wbfmm\_coordinate\_transform\_f}}
\index{wbfmm\_coordinate\_transform\_f@{wbfmm\_coordinate\_transform\_f}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_coordinate\_transform\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+coordinate\+\_\+transform\+\_\+f (\begin{DoxyParamCaption}\item[{gfloat $\ast$}]{x,  }\item[{gfloat $\ast$}]{ix,  }\item[{gfloat $\ast$}]{iy,  }\item[{gfloat $\ast$}]{iz,  }\item[{gfloat $\ast$}]{y }\end{DoxyParamCaption})}



Transform coordinates to rotated axes. 


\begin{DoxyParams}{Parameters}
{\em x} & point coordinates in original axes; \\
\hline
{\em ix} & unit vector in new axes; \\
\hline
{\em iy} & unit vector in new axes; \\
\hline
{\em iz} & unit vector in new axes; \\
\hline
{\em y} & point coordinates in new axes\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_ga51a6d37dda64872d7e85b8a6c53b135e}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_legendre\_init@{wbfmm\_legendre\_init}}
\index{wbfmm\_legendre\_init@{wbfmm\_legendre\_init}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_legendre\_init()}
{\footnotesize\ttfamily gint wbfmm\+\_\+legendre\+\_\+init (\begin{DoxyParamCaption}\item[{gdouble}]{C,  }\item[{gdouble}]{S,  }\item[{gdouble $\ast$}]{P0,  }\item[{gdouble $\ast$}]{P10,  }\item[{gdouble $\ast$}]{P11 }\end{DoxyParamCaption})}



Initialize normalized associated Legendre functions. 


\begin{DoxyParams}{Parameters}
{\em C} & $\cos\theta$; \\
\hline
{\em S} & $\sin\theta$; \\
\hline
{\em P0} & on output $P_{0}^{0}(\cos\theta)$; \\
\hline
{\em P10} & on output $P_{1}^{0}(\cos\theta)$; \\
\hline
{\em P11} & on output $P_{1}^{1}(\cos\theta)$;\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_ga1ad41cb8a6e454dd83061c32763bc9ce}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_legendre\_init\_f@{wbfmm\_legendre\_init\_f}}
\index{wbfmm\_legendre\_init\_f@{wbfmm\_legendre\_init\_f}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_legendre\_init\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+legendre\+\_\+init\+\_\+f (\begin{DoxyParamCaption}\item[{gfloat}]{C,  }\item[{gfloat}]{S,  }\item[{gfloat $\ast$}]{P0,  }\item[{gfloat $\ast$}]{P10,  }\item[{gfloat $\ast$}]{P11 }\end{DoxyParamCaption})}



Initialize normalized associated Legendre functions. 


\begin{DoxyParams}{Parameters}
{\em C} & $\cos\theta$; \\
\hline
{\em S} & $\sin\theta$; \\
\hline
{\em P0} & on output $P_{0}^{0}(\cos\theta)$; \\
\hline
{\em P10} & on output $P_{1}^{0}(\cos\theta)$; \\
\hline
{\em P11} & on output $P_{1}^{1}(\cos\theta)$;\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_ga6e42c928a216fcca40e7b150e4b9161d}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_legendre\_recursion\_array@{wbfmm\_legendre\_recursion\_array}}
\index{wbfmm\_legendre\_recursion\_array@{wbfmm\_legendre\_recursion\_array}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_legendre\_recursion\_array()}
{\footnotesize\ttfamily gint wbfmm\+\_\+legendre\+\_\+recursion\+\_\+array (\begin{DoxyParamCaption}\item[{gdouble $\ast$$\ast$}]{Pnm1,  }\item[{gdouble $\ast$$\ast$}]{Pn,  }\item[{gint}]{n,  }\item[{gdouble}]{C,  }\item[{gdouble}]{S }\end{DoxyParamCaption})}



Perform recursion on normalized associated Legendre functions. 

Perform recursion on normalized associated Legendre functions with input $P_{n-1}^{m}(\cos\theta)$, $0\leq m\leq n-1$, and $P_{n}^{m}(\cos\theta)$, $0\leq m \leq n$, generating equivalent outputs with $n$ incremented by one. Note that the arrays of associated Legendre functions are switched internally to ensure that the ordering remains correct after the recursion step.


\begin{DoxyParams}{Parameters}
{\em Pnm1} & pointer to array of normalized associated Legendre functions for $n-1$; \\
\hline
{\em Pn} & pointer to array of normalized associated Legendre functions for $n$; \\
\hline
{\em n} & order of {\itshape Pn}; \\
\hline
{\em C} & $\cos\theta$; \\
\hline
{\em S} & $\sin\theta$;\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_gad477d3ee1cb9a8e00fe76c3eb043e137}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_legendre\_recursion\_array\_f@{wbfmm\_legendre\_recursion\_array\_f}}
\index{wbfmm\_legendre\_recursion\_array\_f@{wbfmm\_legendre\_recursion\_array\_f}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_legendre\_recursion\_array\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+legendre\+\_\+recursion\+\_\+array\+\_\+f (\begin{DoxyParamCaption}\item[{gfloat $\ast$$\ast$}]{Pnm1,  }\item[{gfloat $\ast$$\ast$}]{Pn,  }\item[{gint}]{n,  }\item[{gfloat}]{C,  }\item[{gfloat}]{S }\end{DoxyParamCaption})}



Perform recursion on normalized associated Legendre functions. 

Perform recursion on normalized associated Legendre functions with input $P_{n-1}^{m}(\cos\theta)$, $0\leq m\leq n-1$, and $P_{n}^{m}(\cos\theta)$, $0\leq m \leq n$, generating equivalent outputs with $n$ incremented by one. Note that the arrays of associated Legendre functions are switched internally to ensure that the ordering remains correct after the recursion step.


\begin{DoxyParams}{Parameters}
{\em Pnm1} & pointer to array of normalized associated Legendre functions for $n-1$; \\
\hline
{\em Pn} & pointer to array of normalized associated Legendre functions for $n$; \\
\hline
{\em n} & order of {\itshape Pn}; \\
\hline
{\em C} & $\cos\theta$; \\
\hline
{\em S} & $\sin\theta$;\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_ga38653b82e8325fd489117afe3bd21b7a}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_points\_origin\_width@{wbfmm\_points\_origin\_width}}
\index{wbfmm\_points\_origin\_width@{wbfmm\_points\_origin\_width}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_points\_origin\_width()}
{\footnotesize\ttfamily gint wbfmm\+\_\+points\+\_\+origin\+\_\+width (\begin{DoxyParamCaption}\item[{gdouble $\ast$}]{x,  }\item[{gint}]{str,  }\item[{gint}]{n,  }\item[{gdouble $\ast$}]{xmin,  }\item[{gdouble $\ast$}]{D,  }\item[{gboolean}]{init\+\_\+limits }\end{DoxyParamCaption})}



Find limits of a cube containing a set of points. 


\begin{DoxyParams}{Parameters}
{\em x} & array of points coordinates; \\
\hline
{\em str} & stride of points in {\itshape x}; \\
\hline
{\em n} & number of points in {\itshape x}; \\
\hline
{\em xmin} & origin of cube containing all points in {\itshape x}; \\
\hline
{\em D} & width of cube containing all points in {\itshape x}; \\
\hline
{\em init\+\_\+limits} & if TRUE initialize limits overwriting any data in xmin\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_gae55dbe2fd85dd2b351c4f9f8cc90bef2}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_points\_origin\_width\_f@{wbfmm\_points\_origin\_width\_f}}
\index{wbfmm\_points\_origin\_width\_f@{wbfmm\_points\_origin\_width\_f}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_points\_origin\_width\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+points\+\_\+origin\+\_\+width\+\_\+f (\begin{DoxyParamCaption}\item[{gfloat $\ast$}]{x,  }\item[{gint}]{str,  }\item[{gint}]{n,  }\item[{gfloat $\ast$}]{xmin,  }\item[{gfloat $\ast$}]{D,  }\item[{gboolean}]{init\+\_\+limits }\end{DoxyParamCaption})}



Find limits of a cube containing a set of points. 


\begin{DoxyParams}{Parameters}
{\em x} & array of points coordinates; \\
\hline
{\em str} & stride of points in {\itshape x}; \\
\hline
{\em n} & number of points in {\itshape x}; \\
\hline
{\em xmin} & origin of cube containing all points in {\itshape x}; \\
\hline
{\em D} & width of cube containing all points in {\itshape x}; \\
\hline
{\em init\+\_\+limits} & if TRUE initialize limits overwriting any data in xmin\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_gada7ba898e9ece32acf9235b4bc7da5cd}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_shift\_angles@{wbfmm\_shift\_angles}}
\index{wbfmm\_shift\_angles@{wbfmm\_shift\_angles}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_shift\_angles()}
{\footnotesize\ttfamily gint wbfmm\+\_\+shift\+\_\+angles (\begin{DoxyParamCaption}\item[{gdouble $\ast$}]{xi,  }\item[{gdouble $\ast$}]{xj,  }\item[{gdouble $\ast$}]{th,  }\item[{gdouble $\ast$}]{ph,  }\item[{gdouble $\ast$}]{ch,  }\item[{gdouble $\ast$}]{r }\end{DoxyParamCaption})}



Compute angles and distance to shift expansion between two points. 

This is a combination of a call to \doxyref{wbfmm\+\_\+shift\+\_\+coordinates}{p.}{group__util_gae41bfd3f13dc28e4438c1cc1d011f7ff} and \doxyref{wbfmm\+\_\+rotation\+\_\+angles}{p.}{group__rotations_ga37773f36d6609f618a982e0a67446354}


\begin{DoxyParams}{Parameters}
{\em xi} & origin of shift; \\
\hline
{\em xj} & destination of shift; \\
\hline
{\em th} & $\theta$ for shift; \\
\hline
{\em ph} & $\phi$ for shift; \\
\hline
{\em ch} & $\chi$ for shift; \\
\hline
{\em r} & distance between source and destination points\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_ga54a0dbcb240ac2de8899c70a1110614a}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_shift\_angles\_f@{wbfmm\_shift\_angles\_f}}
\index{wbfmm\_shift\_angles\_f@{wbfmm\_shift\_angles\_f}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_shift\_angles\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+shift\+\_\+angles\+\_\+f (\begin{DoxyParamCaption}\item[{gfloat $\ast$}]{xi,  }\item[{gfloat $\ast$}]{xj,  }\item[{gfloat $\ast$}]{th,  }\item[{gfloat $\ast$}]{ph,  }\item[{gfloat $\ast$}]{ch,  }\item[{gfloat $\ast$}]{r }\end{DoxyParamCaption})}



Compute angles and distance to shift expansion between two points. 

This is a combination of a call to \doxyref{wbfmm\+\_\+shift\+\_\+coordinates\+\_\+f}{p.}{group__util_gae0bad9f93d0aca22d6af28731fbdbee2} and \doxyref{wbfmm\+\_\+rotation\+\_\+angles\+\_\+f}{p.}{group__rotations_gada5ed4dbfcf5876240f68bba12c0a529}


\begin{DoxyParams}{Parameters}
{\em xi} & origin of shift; \\
\hline
{\em xj} & destination of shift; \\
\hline
{\em th} & $\theta$ for shift; \\
\hline
{\em ph} & $\phi$ for shift; \\
\hline
{\em ch} & $\chi$ for shift; \\
\hline
{\em r} & distance between source and destination points\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_gae41bfd3f13dc28e4438c1cc1d011f7ff}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_shift\_coordinates@{wbfmm\_shift\_coordinates}}
\index{wbfmm\_shift\_coordinates@{wbfmm\_shift\_coordinates}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_shift\_coordinates()}
{\footnotesize\ttfamily gint wbfmm\+\_\+shift\+\_\+coordinates (\begin{DoxyParamCaption}\item[{gdouble $\ast$}]{x,  }\item[{gdouble $\ast$}]{y,  }\item[{gdouble $\ast$}]{ix,  }\item[{gdouble $\ast$}]{iy,  }\item[{gdouble $\ast$}]{iz,  }\item[{gdouble $\ast$}]{r }\end{DoxyParamCaption})}



Find system of axes for coordinate shift. 


\begin{DoxyParams}{Parameters}
{\em x} & origin of shift; \\
\hline
{\em y} & point to shift to; \\
\hline
{\em ix} & on output unit vector of shift axes; \\
\hline
{\em iy} & on output unit vector of shift axes; \\
\hline
{\em iz} & on output unit vector of shift axes in direction of shift; \\
\hline
{\em r} & distance between two input points\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_gae0bad9f93d0aca22d6af28731fbdbee2}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_shift\_coordinates\_f@{wbfmm\_shift\_coordinates\_f}}
\index{wbfmm\_shift\_coordinates\_f@{wbfmm\_shift\_coordinates\_f}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_shift\_coordinates\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+shift\+\_\+coordinates\+\_\+f (\begin{DoxyParamCaption}\item[{gfloat $\ast$}]{x,  }\item[{gfloat $\ast$}]{y,  }\item[{gfloat $\ast$}]{ix,  }\item[{gfloat $\ast$}]{iy,  }\item[{gfloat $\ast$}]{iz,  }\item[{gfloat $\ast$}]{r }\end{DoxyParamCaption})}



Find system of axes for coordinate shift. 


\begin{DoxyParams}{Parameters}
{\em x} & origin of shift; \\
\hline
{\em y} & point to shift to; \\
\hline
{\em ix} & on output unit vector of shift axes; \\
\hline
{\em iy} & on output unit vector of shift axes; \\
\hline
{\em iz} & on output unit vector of shift axes in direction of shift; \\
\hline
{\em r} & distance between two input points\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_gaa5da143192acf9cd3b82e7600ae017c4}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_total\_dipole\_field@{wbfmm\_total\_dipole\_field}}
\index{wbfmm\_total\_dipole\_field@{wbfmm\_total\_dipole\_field}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_total\_dipole\_field()}
{\footnotesize\ttfamily gint wbfmm\+\_\+total\+\_\+dipole\+\_\+field (\begin{DoxyParamCaption}\item[{gdouble}]{k,  }\item[{gdouble $\ast$}]{xs,  }\item[{gint}]{xstride,  }\item[{gdouble $\ast$}]{src,  }\item[{gint}]{sstride,  }\item[{gint}]{nsrc,  }\item[{gdouble $\ast$}]{xf,  }\item[{gdouble $\ast$}]{field }\end{DoxyParamCaption})}



Compute total field from dipole sources by direct evaluation. 

Evaluate the field at some point $\mathbf{x}$ by direct evaluation of the sum over sources at $\mathbf{x}_{n}$ $\sum_{n=1}^{N}\mathbf{f}_{n}.\nabla h_{0}(\mathbf{x}-\mathbf{x}_{n})/4\pi$.


\begin{DoxyParams}{Parameters}
{\em k} & wavenumber; \\
\hline
{\em xs} & array of source positions; \\
\hline
{\em xstride} & stride in {\itshape xs} between source positions; \\
\hline
{\em src} & array of complex vector source strengths; \\
\hline
{\em sstride} & stride in {\itshape src}; \\
\hline
{\em nsrc} & number of sources; \\
\hline
{\em xf} & point for field evaluation; \\
\hline
{\em field} & incremented with computed field\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_ga2272a4de0efc28a2f587b9e30dc65502}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_total\_dipole\_field\_f@{wbfmm\_total\_dipole\_field\_f}}
\index{wbfmm\_total\_dipole\_field\_f@{wbfmm\_total\_dipole\_field\_f}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_total\_dipole\_field\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+total\+\_\+dipole\+\_\+field\+\_\+f (\begin{DoxyParamCaption}\item[{gfloat}]{k,  }\item[{gfloat $\ast$}]{xs,  }\item[{gint}]{xstride,  }\item[{gfloat $\ast$}]{src,  }\item[{gint}]{sstride,  }\item[{gint}]{nsrc,  }\item[{gfloat $\ast$}]{xf,  }\item[{gfloat $\ast$}]{field }\end{DoxyParamCaption})}



Compute total field from dipole sources by direct evaluation. 

Evaluate the field at some point $\mathbf{x}$ by direct evaluation of the sum over sources at $\mathbf{x}_{n}$ $\sum_{n=1}^{N}\mathbf{f}_{n}.\nabla h_{0}(\mathbf{x}-\mathbf{x}_{n})/4\pi$.


\begin{DoxyParams}{Parameters}
{\em k} & wavenumber; \\
\hline
{\em xs} & array of source positions; \\
\hline
{\em xstride} & stride in {\itshape xs} between source positions; \\
\hline
{\em src} & array of complex vector source strengths; \\
\hline
{\em sstride} & stride in {\itshape src}; \\
\hline
{\em nsrc} & number of sources; \\
\hline
{\em xf} & point for field evaluation; \\
\hline
{\em field} & incremented with computed field\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_ga9e2d86423252212034147193f8588a8e}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_total\_field@{wbfmm\_total\_field}}
\index{wbfmm\_total\_field@{wbfmm\_total\_field}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_total\_field()}
{\footnotesize\ttfamily gint wbfmm\+\_\+total\+\_\+field (\begin{DoxyParamCaption}\item[{gdouble}]{k,  }\item[{gdouble $\ast$}]{xs,  }\item[{gint}]{xstride,  }\item[{gdouble $\ast$}]{src,  }\item[{gint}]{sstride,  }\item[{gint}]{nq,  }\item[{gint}]{nsrc,  }\item[{gdouble $\ast$}]{xf,  }\item[{gdouble $\ast$}]{field,  }\item[{gint}]{fstr }\end{DoxyParamCaption})}



Compute total field by direct evaluation. 

Evaluate the field at some point $\mathbf{x}$ by direct evaluation of the sum over sources at $\mathbf{x}_{n}$ $\sum_{n=1}^{N}s_{n}h_{0}(\mathbf{x}-\mathbf{x}_{n})/4\pi$.


\begin{DoxyParams}{Parameters}
{\em k} & wavenumber; \\
\hline
{\em xs} & array of source positions; \\
\hline
{\em xstride} & stride in {\itshape xs} between source positions; \\
\hline
{\em src} & array of complex scalar source strengths; \\
\hline
{\em sstride} & stride in {\itshape src}; \\
\hline
{\em nq} & number of source elements; \\
\hline
{\em nsrc} & number of sources; \\
\hline
{\em xf} & point for field evaluation; \\
\hline
{\em field} & incremented with computed field; \\
\hline
{\em fstr} & stride in field array between components.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_ga027378bb284eeb8c5da6144a6c46fb57}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_total\_field\_f@{wbfmm\_total\_field\_f}}
\index{wbfmm\_total\_field\_f@{wbfmm\_total\_field\_f}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_total\_field\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+total\+\_\+field\+\_\+f (\begin{DoxyParamCaption}\item[{gfloat}]{k,  }\item[{gfloat $\ast$}]{xs,  }\item[{gint}]{xstride,  }\item[{gfloat $\ast$}]{src,  }\item[{gint}]{sstride,  }\item[{gint}]{nq,  }\item[{gint}]{nsrc,  }\item[{gfloat $\ast$}]{xf,  }\item[{gfloat $\ast$}]{field,  }\item[{gint}]{fstr }\end{DoxyParamCaption})}



Compute total field by direct evaluation. 

Evaluate the field at some point $\mathbf{x}$ by direct evaluation of the sum over sources at $\mathbf{x}_{n}$ $\sum_{n=1}^{N}s_{n}h_{0}(\mathbf{x}-\mathbf{x}_{n})/4\pi$.


\begin{DoxyParams}{Parameters}
{\em k} & wavenumber; \\
\hline
{\em xs} & array of source positions; \\
\hline
{\em xstride} & stride in {\itshape xs} between source positions; \\
\hline
{\em src} & array of complex scalar source strengths; \\
\hline
{\em sstride} & stride in {\itshape src}; \\
\hline
{\em nq} & number of source elements; \\
\hline
{\em nsrc} & number of sources; \\
\hline
{\em xf} & point for field evaluation; \\
\hline
{\em field} & incremented with computed field; \\
\hline
{\em fstr} & stride in field array between components.\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_gadfcb43de5aa68a4af89b7e383a82855a}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_tree\_box\_centre@{wbfmm\_tree\_box\_centre}}
\index{wbfmm\_tree\_box\_centre@{wbfmm\_tree\_box\_centre}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_tree\_box\_centre()}
{\footnotesize\ttfamily gint wbfmm\+\_\+tree\+\_\+box\+\_\+centre (\begin{DoxyParamCaption}\item[{\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t,  }\item[{guint32}]{level,  }\item[{guint64}]{b,  }\item[{gdouble $\ast$}]{xb,  }\item[{gdouble $\ast$}]{wb }\end{DoxyParamCaption})}



Find centre and width of box in an octree. 


\begin{DoxyParams}{Parameters}
{\em t} & an octree; \\
\hline
{\em level} & level inside {\itshape t}; \\
\hline
{\em b} & Morton index of box at level {\itshape level}; \\
\hline
{\em xb} & centre of box with index {\itshape b} at level {\itshape level}; \\
\hline
{\em wb} & width of box at level {\itshape level};\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_ga33eba76ae9cab65183e549cfc3e6b8dc}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_tree\_box\_centre\_f@{wbfmm\_tree\_box\_centre\_f}}
\index{wbfmm\_tree\_box\_centre\_f@{wbfmm\_tree\_box\_centre\_f}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_tree\_box\_centre\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+tree\+\_\+box\+\_\+centre\+\_\+f (\begin{DoxyParamCaption}\item[{\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t,  }\item[{guint32}]{level,  }\item[{guint64}]{b,  }\item[{gfloat $\ast$}]{xb,  }\item[{gfloat $\ast$}]{wb }\end{DoxyParamCaption})}



Find centre and width of box in an octree. 


\begin{DoxyParams}{Parameters}
{\em t} & an octree; \\
\hline
{\em level} & level inside {\itshape t}; \\
\hline
{\em b} & Morton index of box at level {\itshape level}; \\
\hline
{\em xb} & centre of box with index {\itshape b} at level {\itshape level}; \\
\hline
{\em wb} & width of box at level {\itshape level};\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_ga821214839e0eadd1cb764094272a2e96}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_tree\_write\_sources@{wbfmm\_tree\_write\_sources}}
\index{wbfmm\_tree\_write\_sources@{wbfmm\_tree\_write\_sources}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_tree\_write\_sources()}
{\footnotesize\ttfamily gint wbfmm\+\_\+tree\+\_\+write\+\_\+sources (\begin{DoxyParamCaption}\item[{\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t,  }\item[{gdouble $\ast$}]{q,  }\item[{gint}]{stride,  }\item[{FILE $\ast$}]{f }\end{DoxyParamCaption})}



Write a tree source list to file. 

Write to file a list of source positions attached to an octree, in order of Morton index by which they are attached to leaf boxes. If source strengths are supplied ({\itshape q} not NULL) these are also written to file.


\begin{DoxyParams}{Parameters}
{\em t} & an octree with a list of sources attached; \\
\hline
{\em q} & source strengths (if NULL, source strengths are not written); \\
\hline
{\em stride} & source strength stride in {\itshape q}; \\
\hline
{\em f} & output file to write to\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\mbox{\label{group__util_ga2cf7845b911013d463c88f62a4a8c7fa}} 
\index{Utility and convenience functions@{Utility and convenience functions}!wbfmm\_tree\_write\_sources\_f@{wbfmm\_tree\_write\_sources\_f}}
\index{wbfmm\_tree\_write\_sources\_f@{wbfmm\_tree\_write\_sources\_f}!Utility and convenience functions@{Utility and convenience functions}}
\doxysubsubsection{wbfmm\_tree\_write\_sources\_f()}
{\footnotesize\ttfamily gint wbfmm\+\_\+tree\+\_\+write\+\_\+sources\+\_\+f (\begin{DoxyParamCaption}\item[{\textbf{ wbfmm\+\_\+tree\+\_\+t} $\ast$}]{t,  }\item[{gfloat $\ast$}]{q,  }\item[{gint}]{stride,  }\item[{FILE $\ast$}]{f }\end{DoxyParamCaption})}



Write a tree source list to file. 

Write to file a list of source positions attached to an octree, in order of Morton index by which they are attached to leaf boxes. If source strengths are supplied ({\itshape q} not NULL) these are also written to file.


\begin{DoxyParams}{Parameters}
{\em t} & an octree with a list of sources attached; \\
\hline
{\em q} & source strengths (if NULL, source strengths are not written); \\
\hline
{\em stride} & source strength stride in {\itshape q}; \\
\hline
{\em f} & output file to write to\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
